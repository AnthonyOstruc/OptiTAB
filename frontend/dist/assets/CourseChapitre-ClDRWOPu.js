import{_ as R,G as H,q as V,h as p,p as I,M as J,B as C,s as O,f as P,w as U,C as j,o,a as t,i as k,c as n,t as i,b as g,j as _,F as b,e as D,u as w}from"./index-C20tTf3S.js";import{D as q}from"./DashboardLayout-DmmXvv68.js";import{B as z}from"./BackButton-B9UoO6zr.js";import{P as G}from"./PDFDownloadButton-DYw0idcX.js";import{d as v}from"./curriculum-C6dJwtfd.js";import{g as M,r as S,a as W,b as $}from"./scientificRenderer-B92-CC0S.js";import"./menuItems-zei-A9he.js";import"./matieres-Ce1WeeoH.js";const K={class:"course-chapitre-section"},Q={class:"course-chapitre-title"},X={class:"display-toggle-container"},Y={class:"toggle-text"},Z={key:0,class:"pdf-buttons-group"},ee={class:"course-header"},te={class:"course-description"},se={class:"course-body"},ae={key:0,class:"loading-state"},oe={key:1,class:"coming-soon"},ne={key:2,class:"cours-list"},re={class:"cours-header"},ce={class:"cours-title"},le={key:0,class:"cours-description"},ie=["innerHTML"],ue={key:1,class:"cours-images"},de=["src","alt"],pe={key:0,class:"image-legende"},he={class:"cours-meta"},ge={class:"cours-date"},_e={key:1,class:"loading-state"},ve=12e4,fe={__name:"CourseChapitre",setup(me){const f=J(),h=j();H(),V();const c=p(null);p([]);const r=p([]),u=p(!0),d=p(!1);async function x(){try{const e=f.params.chapitreId;if(!e){h.back();return}const s=(c.value||await v(e))?.notion;s?h.push({name:"CourseChapitres",params:{notionId:s}}):h.back()}catch(e){console.error("Erreur lors de la navigation:",e),h.back()}}function B(e){return{easy:"Facile",medium:"Moyen",hard:"Difficile"}[e]||e}function L(e){return new Date(e).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})}function N(e){e.target.tagName==="IMG"&&console.log("Image cliqu√©e:",e.target.src)}function F(){d.value=!d.value}function m(e){return`course_chapitre:${e}`}function T(e){try{const a=localStorage.getItem(m(e));if(!a)return null;const s=JSON.parse(a);return!s?.t||!s?.v||Date.now()-s.t>ve?null:s.v}catch{return null}}function y(e,a){try{localStorage.setItem(m(e),JSON.stringify({t:Date.now(),v:a}))}catch{}}return I(async()=>{u.value=!0;try{const e=f.params.chapitreId;if(!e)return;const a=T(e);if(a){c.value=a.chapitre||null,r.value=Array.isArray(a.cours)?a.cours:[],u.value=!1,v(e).then(async A=>{const{data:E}=await M(null,null,e);y(e,{chapitre:A,cours:E||[]})}).catch(()=>{});return}const s=await v(e);c.value=s;const{data:l}=await M(null,null,e);r.value=l||[],y(e,{chapitre:s,cours:r.value}),C(()=>{S()})}catch(e){console.error("Erreur lors du chargement du cours:",e),c.value=null,r.value=[]}finally{u.value=!1}}),O(r,()=>{C(()=>{S()})},{deep:!0}),(e,a)=>(o(),P(q,null,{default:U(()=>[t("section",K,[k(z,{text:"Retour aux chapitres",customAction:x,position:"top-left"}),t("h2",Q,i(c.value?.nom||"Cours en ligne"),1),t("div",X,[t("button",{class:_(["display-toggle-btn",{active:d.value}]),onClick:F},[a[0]||(a[0]=t("span",{class:"toggle-icon"},[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M3 3h18v18H3z"}),t("path",{d:"M3 9h18"}),t("path",{d:"M9 21V9"})])],-1)),t("span",Y,i(d.value?"Normal":"Large"),1)],2),!u.value&&r.value.length>0?(o(),n("div",Z,[k(G,{type:"cours",data:r.value,title:`Cours_${c.value?.nom||"Chapitre"}`,text:"üìÑ PDF",useMathJax:!0,includeSolution:!1,class:"pdf-btn-compact"},null,8,["data","title"])])):g("",!0)]),c.value?(o(),n("div",{key:0,class:_(["course-content",{"wide-display":d.value}])},[t("div",ee,[t("p",te,i(c.value.description),1)]),t("div",se,[u.value?(o(),n("div",ae,a[1]||(a[1]=[t("div",{class:"loading-spinner"},null,-1),t("span",null,"Chargement des cours...",-1)]))):r.value.length===0?(o(),n("div",oe,a[2]||(a[2]=[t("div",{class:"coming-soon-icon"},"üìö",-1),t("h3",null,"Aucun cours disponible",-1),t("p",null,"Il n'y a pas encore de cours pour ce chapitre.",-1),t("p",null,"Les cours seront bient√¥t disponibles.",-1)]))):(o(),n("div",ne,[(o(!0),n(b,null,D(r.value,s=>(o(),n("div",{key:s.id,class:"cours-item"},[t("div",re,[t("h3",ce,i(s.titre),1),t("span",{class:_(["cours-difficulty",s.difficulty])},i(B(s.difficulty)),3)]),s.description?(o(),n("div",le,i(s.description),1)):g("",!0),t("div",{class:"cours-content",innerHTML:w(W)(s.contenu,s.images),onClick:N},null,8,ie),s.images&&s.images.length>0?(o(),n("div",ue,[(o(!0),n(b,null,D(s.images,l=>(o(),n("div",{key:l.id,class:"cours-image"},[t("img",{src:w($)(l.image),alt:l.legende||l.image_type},null,8,de),l.legende?(o(),n("div",pe,i(l.legende),1)):g("",!0)]))),128))])):g("",!0),t("div",he,[t("span",ge,"Cr√©√© le "+i(L(s.date_creation)),1)])]))),128))]))])],2)):(o(),n("div",_e,a[3]||(a[3]=[t("div",{class:"loading-spinner"},null,-1),t("span",null,"Chargement du cours...",-1)])))])]),_:1}))}},xe=R(fe,[["__scopeId","data-v-7fcc122a"]]);export{xe as default};
