import{D as Xe}from"./DashboardLayout-B5CnNSIn.js";import{_ as te,u as de,f as Qe,a as qe,b as O,X as Ve,c as Be,d as He,e as Oe,g as Ue,h as Ne,i as Fe,r as Je}from"./index-Bvm2JEkS.js";import{a as _,c as T,C as We,B as ee,b as a,o as t,d as e,n as Q,g as $,j as G,u as q,t as i,F as L,p as B,m as xe,f as Se,A as le,G as Ge,E as je,k as Z,L as pe,w as ge,z as Pe,y as ye,i as fe,h as ne,K as Ce,J as Ke}from"./vendor-D171CWhe.js";import{g as ze,a as re,b as Le,c as Ye}from"./curriculum-Ch8J6CLY.js";import{g as Te}from"./matieres-UO5rRmLj.js";import{g as Ze}from"./exercices-CWs1pYtm.js";import{c as et}from"./quiz-C0dQ8Pww.js";import{useDailyObjectives as tt}from"./useDailyObjectives-KKZq7PFm.js";import"./menuItems-D4F2gOe0.js";import"./ui-jaH5oyHW.js";import"./pdf-B39ievqC.js";import"./mathlive-B5k0jhbN.js";const st={class:"leaderboard-card"},at={class:"leaderboard-header"},it={class:"leaderboard-tabs"},ot=["disabled"],nt={key:0,class:"flag"},lt=["disabled"],rt={key:0,class:"leaderboard-body"},dt={class:"leaderboard-content"},ct={key:0,class:"leaderboard-item me-item"},ut={class:"rank"},vt={class:"me-rank"},pt={class:"me-sub"},mt={class:"user"},_t={class:"info"},ht={class:"meta"},ft={key:0,class:"flag"},gt={key:1,class:"niveau"},yt={class:"xp"},bt={class:"me-xp"},$t={class:"me-percent"},kt={class:"leaderboard-list"},wt={class:"rank"},Ct={key:0,class:"trophy gold"},xt={key:1,class:"trophy silver"},St={key:2,class:"trophy bronze"},Pt={key:3},zt={class:"user"},At={class:"avatar"},It={class:"info"},Et={class:"name"},Dt={key:0,class:"flag name-flag"},jt={class:"first-name"},Tt={class:"last-name"},Mt={key:0,class:"meta"},Rt={class:"xp"},Nt={key:1,class:"expanded-section"},qt={class:"expanded-header"},Lt={class:"expanded-count"},Xt={class:"leaderboard-list"},Qt={class:"rank"},Vt={class:"user"},Bt={class:"avatar"},Ht={class:"info"},Ot={class:"name"},Ut={key:0,class:"flag name-flag"},Ft={class:"first-name"},Jt={class:"last-name"},Wt={key:0,class:"meta"},Gt={class:"xp"},Kt={key:0,class:"leaderboard-actions"},Yt=["disabled"],Zt={key:1,class:"empty-state"},es={key:1,class:"leaderboard-loading"},ts={__name:"LeaderboardWidget",setup(H){const w=de(),k=_("global"),x=_(!0);_([]);const C=_(null),A=_(!1),S=_([]),N=T(()=>!!w?.pays?.id),g=T(()=>!!w?.niveau_pays?.id);function f(m){m==="pays"&&!N.value||m==="niveau"&&!g.value||(k.value=m)}function j(m){if(!m)return"U";const d=String(m).trim().split(/\s+/);return d.length===1?d[0].substring(0,2).toUpperCase():(d[0].substring(0,1)+d[1].substring(0,1)).toUpperCase()}function P(m){const d=String(m||"").trim();if(!d)return{firstName:"",lastName:""};const u=d.split(/\s+/),y=u[0]||"",n=u.slice(1).join(" ")||"";return{firstName:y,lastName:n}}async function z(){x.value=!0;try{const d=(await Qe({scope:k.value,limit:50}))?.data?.data||{},u=d.leaderboard||[];S.value=u.slice(0,50),C.value=d.me||null,A.value=!1}catch{S.value=[],C.value=null}finally{x.value=!1}}async function I(){A.value=!0}function D(){A.value=!1}return We(k,()=>z()),ee(()=>z()),(m,d)=>(t(),a("div",st,[e("div",at,[d[4]||(d[4]=e("h3",{class:"leaderboard-title"},"Classement",-1)),e("div",it,[e("button",{class:Q(["tab",{active:k.value==="global"}]),onClick:d[0]||(d[0]=u=>f("global"))},"Global",2),e("button",{class:Q(["tab",{active:k.value==="pays"}]),onClick:d[1]||(d[1]=u=>f("pays")),disabled:!N.value},[q(w).pays?.drapeau_emoji?(t(),a("span",nt,i(q(w).pays?.drapeau_emoji),1)):$("",!0),d[3]||(d[3]=G(" Pays "))],10,ot),e("button",{class:Q(["tab",{active:k.value==="niveau"}]),onClick:d[2]||(d[2]=u=>f("niveau")),disabled:!g.value}," Niveau ",10,lt)])]),x.value?(t(),a("div",es,[d[10]||(d[10]=e("div",{class:"skeleton me"},null,-1)),(t(),a(L,null,B(6,u=>e("div",{class:"skeleton row",key:u})),64))])):(t(),a("div",rt,[e("div",dt,[C.value?(t(),a("div",ct,[e("div",ut,[e("div",vt,"#"+i(C.value.rank),1),e("div",pt,"sur "+i(C.value.total),1)]),e("div",mt,[e("div",_t,[d[5]||(d[5]=e("div",{class:"name"},"Vous",-1)),e("div",ht,[C.value.pays_flag?(t(),a("span",ft,i(C.value.pays_flag),1)):$("",!0),C.value.niveau?(t(),a("span",gt,i(C.value.niveau),1)):$("",!0)])])]),e("div",yt,[e("div",bt,i(C.value.xp)+" XP",1),e("div",$t,"Top "+i(C.value.percentile)+"%",1)])])):$("",!0),e("ul",kt,[(t(!0),a(L,null,B(S.value.slice(0,5),u=>(t(),a("li",{key:u.id,class:"leaderboard-item"},[e("div",wt,[u.rank===1?(t(),a("span",Ct,"🥇")):u.rank===2?(t(),a("span",xt,"🥈")):u.rank===3?(t(),a("span",St,"🥉")):(t(),a("span",Pt,"#"+i(u.rank),1))]),e("div",zt,[e("div",At,i(j(u.display_name)),1),e("div",It,[e("div",Et,[u.pays_flag?(t(),a("span",Dt,i(u.pays_flag),1)):$("",!0),e("span",jt,i(P(u.display_name).firstName),1),e("span",Tt,i(P(u.display_name).lastName),1)]),u.niveau?(t(),a("div",Mt,i(u.niveau),1)):$("",!0)])]),e("div",Rt,i(u.xp)+" XP",1)]))),128))]),A.value&&S.value.length>5?(t(),a("div",Nt,[e("div",qt,[d[6]||(d[6]=e("span",{class:"expanded-title"},"Autres classés",-1)),e("span",Lt,i(Math.min(S.value.length-5,45))+" utilisateurs",1)]),e("ul",Xt,[(t(!0),a(L,null,B(S.value.slice(5,50),u=>(t(),a("li",{key:u.id,class:"leaderboard-item expanded-item"},[e("div",Qt," #"+i(u.rank),1),e("div",Vt,[e("div",Bt,i(j(u.display_name)),1),e("div",Ht,[e("div",Ot,[u.pays_flag?(t(),a("span",Ut,i(u.pays_flag),1)):$("",!0),e("span",Ft,i(P(u.display_name).firstName),1),e("span",Jt,i(P(u.display_name).lastName),1)]),u.niveau?(t(),a("div",Wt,i(u.niveau),1)):$("",!0)])]),e("div",Gt,i(u.xp)+" XP",1)]))),128))])])):$("",!0)]),S.value.length>0?(t(),a("div",Kt,[A.value?(t(),a("button",{key:1,onClick:D,class:"btn-see-less"},d[8]||(d[8]=[e("span",{class:"btn-text"},"Voir moins",-1)]))):(t(),a("button",{key:0,onClick:I,class:"btn-see-more",disabled:x.value||S.value.length<=5},d[7]||(d[7]=[e("span",{class:"btn-text"},"Voir plus",-1)]),8,Yt))])):$("",!0),S.value.length?$("",!0):(t(),a("div",Zt,d[9]||(d[9]=[e("div",null,"Pas encore de classement pour ce filtre.",-1)])))]))]))}},ss=te(ts,[["__scopeId","data-v-32a3f080"]]),as={class:"xp-card"},is={class:"xp-header"},os={class:"xp-level"},ns={class:"xp-ring"},ls={viewBox:"0 0 36 36",class:"circular-chart"},rs=["stroke-dasharray"],ds={x:"18",y:"20.35",class:"percentage"},cs={class:"xp-next"},us={class:"streak-section"},vs={class:"streak-header"},ps={class:"streak-icon-container"},ms={key:0,class:"streak-badge"},_s={class:"streak-info"},hs={class:"streak-subtitle"},fs={key:0,class:"streak-next-xp"},gs={class:"streak-xp-display"},ys={class:"xp-icon"},bs={class:"xp-value"},$s={class:"streak-progress-container"},ks={class:"streak-progress-bar"},ws={class:"streak-progress-text"},Cs={key:0,class:"streak-motivation"},xs={class:"motivation-text"},Ss={__name:"XPBadges",setup(H){const w=de(),{initializeStreak:k,currentStreak:x,nextStreakXP:C}=qe(),A=T(()=>w.level||0),S=T(()=>w.xp||0),N=T(()=>w.xp_to_next||0),g=T(()=>x.value),f=T(()=>g.value===0?0:g.value<=7?g.value/7*100:((g.value-1)%7+1)/7*100),j=T(()=>{if(g.value===0)return"Commencez votre streak !";if(g.value<=7)return`${g.value}/7 jours`;const d=(g.value-1)%7+1,u=Math.floor((g.value-1)/7)+1;return`${d}/7 jours (semaine ${u})`}),P=()=>g.value===0?"Connectez-vous chaque jour pour gagner des XP":g.value===1?"Excellent début ! Continuez demain":g.value<7?`${g.value} jours consécutifs`:g.value<30?`${g.value} jours - Vous êtes régulier !`:`${g.value} jours - Vous êtes un champion !`,z=()=>{const d=["Continuez comme ça ! Chaque jour compte.","Vous construisez une habitude d'apprentissage solide !","Impressionnant ! Votre persévérance paie.","Vous êtes sur la bonne voie vers la maîtrise !","Chaque jour d'apprentissage vous rapproche de vos objectifs."],u=Math.min(Math.floor(g.value/5),d.length-1);return d[u]},I=()=>g.value===0?1:g.value<=5?g.value:5,D=()=>{const d=I();return d>=5?"👑":d>=3?"🏆":d>=2?"⭐":"💎"},m=T(()=>{const d=Number(A.value||0),u=Number(S.value||0),y=d*d*10,n=(d+1)*(d+1)*10,b=Math.max(u,y)-y,F=Math.max(1,n-y);return`${Math.min(100,Math.round(b/F*100))}, 100`});return ee(()=>{k()}),(d,u)=>(t(),a("div",as,[e("div",is,[u[0]||(u[0]=e("div",{class:"xp-title"},"Progression XP",-1)),e("div",os,"Niveau "+i(A.value),1)]),e("div",ns,[(t(),a("svg",ls,[u[1]||(u[1]=e("path",{class:"circle-bg",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"},null,-1)),e("path",{class:"circle","stroke-dasharray":m.value,d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"},null,8,rs),e("text",ds,i(S.value)+" XP",1)]))]),e("div",cs,i(N.value)+" XP pour le prochain niveau",1),e("div",us,[e("div",vs,[e("div",ps,[e("span",{class:Q(["streak-icon",{"streak-active":g.value>0}])},"🔥",2),g.value>0?(t(),a("div",ms,i(g.value),1)):$("",!0)]),e("div",_s,[u[2]||(u[2]=e("h4",{class:"streak-title"},"Streak Quotidien",-1)),e("p",hs,i(P()),1),g.value>0?(t(),a("p",fs,"Prochain: +"+i(q(C))+" XP",1)):$("",!0)]),e("div",gs,[e("span",ys,i(D()),1),e("span",bs,"+"+i(I())+" XP",1)])]),e("div",$s,[e("div",ks,[e("div",{class:"streak-progress-fill",style:xe({width:f.value+"%"})},null,4)]),e("div",ws,i(j.value),1)]),g.value>0?(t(),a("div",Cs,[e("p",xs,i(z()),1)])):$("",!0)])]))}},Ps=te(Ss,[["__scopeId","data-v-b0d85bb8"]]),zs={key:0,class:"game-reset-notification"},As={__name:"GameResetNotification",props:{autoHide:{type:Number,default:8e3}},setup(H){const w=H,k=_(!1);function x(){k.value=!1,localStorage.setItem("game-reset-notification-seen","true")}return ee(()=>{localStorage.getItem("game-reset-notification-seen")||(k.value=!0,w.autoHide>0&&setTimeout(()=>{k.value&&x()},w.autoHide))}),(C,A)=>(t(),Se(Ge,{name:"notification",appear:""},{default:le(()=>[k.value?(t(),a("div",zs,[A[0]||(A[0]=e("div",{class:"notification-icon"},[e("span",null,"🎮")],-1)),A[1]||(A[1]=e("div",{class:"notification-content"},[e("div",{class:"notification-title"}," Système de gamification mis à jour ! "),e("div",{class:"notification-message"},[e("p",null,[G("🎯 "),e("strong",null,"Nouveau :"),G(" Seuls les "),e("strong",null,"quiz"),G(" donnent maintenant des XP")]),e("p",null,"📚 Les exercices guidés restent éducatifs (0 XP)"),e("p",null,"🏆 Tous les compteurs ont été remis à zéro pour un restart équitable")])],-1)),e("button",{onClick:x,class:"notification-close"}," ✕ ")])):$("",!0)]),_:1}))}},Is=te(As,[["__scopeId","data-v-64a66099"]]),Es={class:"quiz-history"},Ds={class:"quiz-header"},js={class:"quiz-filters"},Ts=["value"],Ms=["disabled"],Rs=["value"],Ns=["disabled"],qs=["value"],Ls={key:0,class:"stats-section"},Xs={class:"stats-grid"},Qs={class:"stat-card quiz-completed"},Vs={class:"stat-value"},Bs={class:"stat-card quiz-average"},Hs={class:"stat-value"},Os={class:"stat-card quiz-notions"},Us={class:"stat-value"},Fs={key:1,class:"matiere-stats"},Js={class:"matiere-grid"},Ws={class:"matiere-name"},Gs={class:"matiere-info"},Ks={class:"matiere-average"},Ys={class:"matiere-count"},Zs={key:2,class:"quiz-list-section"},ea={class:"section-subtitle"},ta={class:"inline-mastery-filters"},sa=["onClick","title","aria-label"],aa={key:0,class:"inline-mastery-icon"},ia={class:"inline-mastery-label"},oa={key:0,class:"quiz-list-content"},na={key:0,class:"empty-state"},la={key:1,class:"quiz-grid"},ra=["onClick"],da={class:"quiz-card-title-section"},ca=["onClick","title"],ua={key:0,class:"cooldown-lock",title:"Quiz en cooldown"},va={key:1,class:"navigation-icon",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},pa={class:"quiz-breadcrumb-compact"},ma={class:"quiz-card-actions"},_a={key:0,class:"retry-indicator"},ha={key:0,class:"quiz-card-details"},fa={class:"quiz-breadcrumb"},ga={class:"breadcrumb-item"},ya={class:"breadcrumb-item"},ba={class:"breadcrumb-item"},$a={class:"quiz-meta"},ka={class:"quiz-attempt"},wa={key:0,class:"total-attempts"},Ca={class:"quiz-date"},xa={key:0,class:"quiz-time"},Sa={key:0,class:"quiz-cooldown-info"},Pa={class:"cooldown-warning"},za={class:"cooldown-text"},Aa={key:2,class:"pagination-container"},Ia=["disabled"],Ea={class:"pagination-pages"},Da=["onClick"],ja=["disabled"],Ta={key:3,class:"loading-state"},De=6,Ma={__name:"QuizHistory",setup(H){const w=de(),k=ye(),x=_(!0),C=_({completed:0,average:0,masteredNotions:0}),A=_([]),S=_([]),N=_([]),g=_([]),f=_([]),j=_({}),P=_(""),z=_(""),I=_(""),D=_("all"),m=_(1),d=_(new Set),u=_(!0),y=_(new Map),n=_(!1),r=_(!1),b=()=>{typeof window<"u"&&(r.value=window.innerWidth<=768)},F=T(()=>{if(!P.value)return[];const l=parseInt(P.value);return g.value.filter(s=>{const h=typeof s.theme=="object"?s.theme?.id:s.theme;let M=null;return typeof s.theme=="object"&&(M=s.theme?.matiere_id||s.theme?.matiere?.id||null),!M&&h&&j.value[h]&&(M=j.value[h].matiere_id||j.value[h].matiere),parseInt(M)===l})}),J=T(()=>{if(!z.value)return[];const l=parseInt(z.value);return f.value.filter(o=>{const s=o.notion_id??o.notion?.id??(typeof o.notion=="number"?o.notion:null);return parseInt(s)===l})}),K=T(()=>{let l=A.value;return D.value!=="all"&&(l=l.filter(o=>{const s=o.score_on_10;switch(D.value){case"mastered":return s>=7;case"average":return s>=5&&s<7;case"poor":return s<5;default:return!0}})),l}),se=T(()=>Math.ceil(K.value.length/De)),ce=T(()=>{const l=(m.value-1)*De,o=l+De;return K.value.slice(l,o)}),oe=T(()=>N.value||[]),X=T(()=>{const l=[],o=se.value,s=m.value;if(r.value)return o<=1?[1]:[1,"...",o];if(o<=7)for(let h=1;h<=o;h++)l.push(h);else if(s<=4){for(let h=1;h<=5;h++)l.push(h);o>5&&l.push("..."),l.push(o)}else if(s>=o-3){l.push(1),o>6&&l.push("...");for(let h=o-4;h<=o;h++)h>1&&l.push(h)}else{l.push(1),l.push("...");for(let h=s-1;h<=s+1;h++)l.push(h);l.push("..."),l.push(o)}return l}),V=[{value:"all",label:"Tous",icon:"",class:"all"},{value:"mastered",label:"Maîtrisés",icon:"✅",class:"mastered"},{value:"average",label:"Moyens",icon:"⚠️",class:"average"},{value:"poor",label:"Non maîtrisés",icon:"❌",class:"poor"}],U=async()=>{if(A.value.length){n.value=!0;try{for(const l of A.value)try{const o=await et(l.quiz_id);y.value.set(l.quiz_id,o)}catch{y.value.set(l.quiz_id,{can_attempt:!0})}}catch{}finally{n.value=!1}}},Y=l=>y.value.get(l)||{can_attempt:!0},ae=l=>!Y(l).can_attempt,Ae=async()=>{try{const[l,o,s,h]=await Promise.all([O.get("/api/matieres/user_matieres/",{timeout:2e4}).catch(()=>O.get("/api/matieres/user_matieres/")),O.get("/api/themes/notions-pour-utilisateur/",{timeout:2e4}).catch(()=>O.get("/api/themes/notions-pour-utilisateur/")),ze({}).catch(()=>O.get("/api/notions/pour-utilisateur/",{timeout:2e4})),re({})]);let M=[];l?.data?.matieres_disponibles?M=l.data.matieres_disponibles:l?.data?.data?M=l.data.data:Array.isArray(l?.data)&&(M=l.data);let W=[];s?.data?.notions_disponibles?W=s.data.notions_disponibles:s?.data?.data?W=s.data.data:Array.isArray(s?.data)?W=s.data:s?.data?.results&&(W=s.data.results);const ie=o?.data?.themes||[],R=o?.data?.notions||[],_e={};ie.forEach(he=>{const Re=he.matiere_id||he.matiere&&(he.matiere.id||he.matiere);_e[he.id]={matiere_id:Re,matiere:Re}}),j.value=_e,Array.isArray(R)&&R.length>0&&(W=R);const Me=Array.isArray(h?.data)?h.data:h?.results||[];N.value=Array.isArray(M)?M:[],g.value=Array.isArray(W)?W:[],f.value=Array.isArray(Me)?Me:[],await Pe()}catch{try{const[o,s,h]=await Promise.all([Te({}),ze({}),re({})]);N.value=Array.isArray(o?.data)?o.data:o?.results||[],g.value=Array.isArray(s?.data)?s.data:s?.results||[],f.value=Array.isArray(h?.data)?h.data:h?.results||[],await Pe()}catch{}}},ue=async()=>{x.value=!0;try{const l={};P.value&&(l.matiere=P.value),z.value&&(l.notion=z.value),I.value&&(l.chapitre=I.value);const s=(await O.get("/api/suivis/quiz/stats/",{params:l,timeout:2e4})).data;C.value=s.global_stats||{completed:0,average:0,masteredNotions:0},A.value=s.quiz_list||[],S.value=s.matiere_stats||[],A.value.length>0&&await U()}catch{}finally{x.value=!1}},be=async()=>{if(z.value="",I.value="",E(),P.value&&F.value.length===0)try{const l=await O.get("/api/themes/notions-pour-utilisateur/",{params:{matiere:P.value}}),o=l?.data?.themes||[],s=l?.data?.notions||[],h={};o.forEach(R=>{const _e=R.matiere_id||R.matiere&&(R.matiere.id||R.matiere);h[R.id]={matiere_id:_e,matiere:_e}}),j.value={...j.value,...h};let M=s;if(!Array.isArray(M)||M.length===0){const R=await O.get("/api/notions/pour-utilisateur/",{params:{matiere:P.value}});R?.data?.notions_disponibles?M=R.data.notions_disponibles:R?.data?.data?M=R.data.data:Array.isArray(R?.data)?M=R.data:R?.data?.results&&(M=R.data.results)}const W=g.value.map(R=>R.id),ie=M.filter(R=>!W.includes(R.id));g.value=[...g.value,...ie]}catch{}ue()},$e=async()=>{if(I.value="",E(),z.value)try{let l=await Le(z.value),o=[];if(Array.isArray(l?.data)?o=l.data:l?.data?.results&&(o=l.data.results),o.length===0){const s=await re({notion:z.value});Array.isArray(s?.data)?o=s.data:s?.data?.results&&(o=s.data.results)}if(o.length===0){const s=await O.get(`/api/notions/${z.value}/chapitres/`);Array.isArray(s?.data)?o=s.data:s?.data?.results&&(o=s.data.results)}if(o.length>0){const s=f.value.map(M=>M.id),h=o.filter(M=>!s.includes(M.id));f.value=[...f.value,...h]}}catch{}ue()},Ie=()=>{E(),ue()},ke=l=>l>=7?"score-good":l>=5?"score-average":"score-poor",me=l=>new Date(l).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),ve=l=>{const o=Math.floor(l/60),s=l%60;return`${o}:${s.toString().padStart(2,"0")}`},Ee=l=>{d.value.has(l)?d.value.delete(l):d.value.add(l)},we=l=>d.value.has(l),p=()=>{u.value=!u.value},v=async l=>{try{if(ae(l.quiz_id)){const h=Y(l.quiz_id);alert(`⏰ Ce quiz est en cooldown. ${h.message}`);return}const o=l.chapitre.id,s=l.quiz_id;await k.push({path:`/quiz-exercices/${o}`,query:{quizId:s,autoStart:"true"}})}catch{}},c=l=>{typeof l=="number"&&l>=1&&l<=se.value&&(m.value=l)},E=()=>{m.value=1};return ee(async()=>{if(b(),typeof window<"u"&&window.addEventListener("resize",b),w.isLoading||!w.isAuthenticated&&!w.id){let l=0;for(;(w.isLoading||!w.isAuthenticated)&&l<30;)await new Promise(o=>setTimeout(o,100)),l++}await Ae(),await ue()}),je(()=>{typeof window<"u"&&window.removeEventListener("resize",b)}),(l,o)=>(t(),a("div",Es,[e("div",Ds,[o[8]||(o[8]=e("h3",{class:"quiz-title"},"🧠 Historique des Quiz",-1)),e("div",js,[Z((t(),a("select",{"onUpdate:modelValue":o[0]||(o[0]=s=>P.value=s),onChange:be,class:"filter-select",key:"matieres-"+oe.value.length},[o[5]||(o[5]=e("option",{value:""},"Toutes les matières",-1)),(t(!0),a(L,null,B(oe.value,s=>(t(),a("option",{key:`matiere-${s.id}`,value:s.id},i(s.titre||s.nom),9,Ts))),128))],32)),[[pe,P.value]]),Z(e("select",{"onUpdate:modelValue":o[1]||(o[1]=s=>z.value=s),onChange:$e,class:"filter-select",disabled:!P.value},[o[6]||(o[6]=e("option",{value:""},"Toutes les notions",-1)),(t(!0),a(L,null,B(F.value,s=>(t(),a("option",{key:s.id,value:s.id},i(s.titre),9,Rs))),128))],40,Ms),[[pe,z.value]]),Z(e("select",{"onUpdate:modelValue":o[2]||(o[2]=s=>I.value=s),onChange:Ie,class:"filter-select",disabled:!z.value},[o[7]||(o[7]=e("option",{value:""},"Tous les chapitres",-1)),(t(!0),a(L,null,B(J.value,s=>(t(),a("option",{key:s.id,value:s.id},i(s.titre),9,qs))),128))],40,Ns),[[pe,I.value]])])]),x.value?$("",!0):(t(),a("div",Ls,[e("div",Xs,[e("div",Qs,[o[9]||(o[9]=e("span",{class:"stat-label"},"Quiz effectués",-1)),e("span",Vs,i(C.value.completed),1)]),e("div",Bs,[o[10]||(o[10]=e("span",{class:"stat-label"},"Note moyenne",-1)),e("span",Hs,i(C.value.average)+"/10",1)]),e("div",Os,[o[11]||(o[11]=e("span",{class:"stat-label"},"Notions maîtrisées",-1)),e("span",Us,i(C.value.masteredNotions),1)])])])),!x.value&&S.value.length>0?(t(),a("div",Fs,[o[12]||(o[12]=e("h4",{class:"section-subtitle"},"📊 Moyennes par matière",-1)),e("div",Js,[(t(!0),a(L,null,B(S.value,s=>(t(),a("div",{key:s.id,class:"matiere-card"},[e("div",Ws,i(s.titre),1),e("div",Gs,[e("span",Ks,i(s.average)+"/10",1),e("span",Ys,i(s.quiz_count)+" quiz",1)])]))),128))])])):$("",!0),x.value?$("",!0):(t(),a("div",Zs,[e("div",{class:"quiz-list-header",onClick:p},[e("h4",ea,"📝 Quiz effectués ("+i(K.value.length)+")",1),e("div",ta,[(t(),a(L,null,B(V,s=>e("button",{key:s.value,onClick:ge(h=>D.value=s.value,["stop"]),class:Q(["inline-mastery-btn",{active:D.value===s.value},s.class]),title:s.label,"aria-label":s.label},[s.icon?(t(),a("span",aa,i(s.icon),1)):$("",!0),e("span",ia,i(s.label),1)],10,sa)),64))]),e("button",{class:Q(["section-toggle",{expanded:u.value}])},o[13]||(o[13]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"6,9 12,15 18,9"})],-1)]),2)]),u.value?(t(),a("div",oa,[K.value.length===0?(t(),a("div",na,o[14]||(o[14]=[e("p",null,"Aucun quiz trouvé avec ces filtres",-1)]))):(t(),a("div",la,[(t(!0),a(L,null,B(ce.value,s=>(t(),a("div",{key:s.id,class:Q(["quiz-card",{"multiple-attempts":s.total_attempts>1,cooldown:ae(s.quiz_id)}])},[e("div",{class:"quiz-card-header",onClick:h=>Ee(s.id)},[e("div",da,[e("h5",{class:Q(["quiz-card-title clickable-title",{"cooldown-title":ae(s.quiz_id)}]),onClick:ge(h=>v(s),["stop"]),title:ae(s.quiz_id)?"Quiz en cooldown - Accès temporairement bloqué":"Accéder au quiz: "+s.quiz_titre},[ae(s.quiz_id)?(t(),a("span",ua,"🔒")):$("",!0),G(" "+i(s.quiz_titre)+" ",1),ae(s.quiz_id)?$("",!0):(t(),a("svg",va,o[15]||(o[15]=[e("path",{d:"M7 17l9.2-9.2M17 17V7H7"},null,-1)])))],10,ca),e("div",pa,i(s.matiere.titre)+" → "+i(s.notion.titre),1)]),e("div",ma,[e("div",{class:Q(["quiz-score",ke(s.score_on_10)])},[G(i(s.score_on_10)+"/10 ",1),s.total_attempts>1?(t(),a("span",_a,"↻")):$("",!0)],2),e("button",{class:Q(["expand-toggle",{expanded:we(s.id)}])},o[16]||(o[16]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"6,9 12,15 18,9"})],-1)]),2)])],8,ra),we(s.id)?(t(),a("div",ha,[e("div",fa,[e("span",ga,i(s.matiere.titre),1),o[17]||(o[17]=e("span",{class:"breadcrumb-separator"},"→",-1)),e("span",ya,i(s.notion.titre),1),o[18]||(o[18]=e("span",{class:"breadcrumb-separator"},"→",-1)),e("span",ba,i(s.chapitre.titre),1)]),e("div",$a,[e("span",ka,[G(" Tentative #"+i(s.tentative_numero)+" ",1),s.total_attempts>1?(t(),a("span",wa," ("+i(s.total_attempts)+" au total) ",1)):$("",!0)]),e("span",Ca,i(me(s.date_creation)),1),s.temps_total_seconde?(t(),a("span",xa,i(ve(s.temps_total_seconde)),1)):$("",!0)]),ae(s.quiz_id)?(t(),a("div",Sa,[e("div",Pa,[o[19]||(o[19]=e("span",{class:"cooldown-icon"},"⏰",-1)),e("span",za," Prochaine tentative possible dans "+i(Y(s.quiz_id).time_remaining_formatted),1)])])):$("",!0)])):$("",!0)],2))),128))])),se.value>1?(t(),a("div",Aa,[e("button",{onClick:o[3]||(o[3]=s=>c(m.value-1)),disabled:m.value<=1,class:"pagination-btn prev",title:"Précédent","aria-label":"Précédent"},o[20]||(o[20]=[e("span",{class:"pagination-icon"},"‹",-1),e("span",{class:"pagination-label"},"Précédent",-1)]),8,Ia),e("div",Ea,[(t(!0),a(L,null,B(X.value,s=>(t(),a("button",{key:s,onClick:h=>c(s),class:Q(["pagination-page",{active:s===m.value}])},i(s),11,Da))),128))]),e("button",{onClick:o[4]||(o[4]=s=>c(m.value+1)),disabled:m.value>=se.value,class:"pagination-btn next",title:"Suivant","aria-label":"Suivant"},o[21]||(o[21]=[e("span",{class:"pagination-label"},"Suivant",-1),e("span",{class:"pagination-icon"},"›",-1)]),8,ja)])):$("",!0)])):$("",!0)])),x.value?(t(),a("div",Ta,o[22]||(o[22]=[e("div",{class:"spinner"},null,-1),e("p",null,"Chargement des quiz...",-1)]))):$("",!0)]))}},Ra=te(Ma,[["__scopeId","data-v-ac075a17"]]),Na={class:"base-history"},qa={class:"history-header"},La={class:"history-title"},Xa={class:"history-filters"},Qa=["value"],Va=["disabled"],Ba=["value"],Ha=["disabled"],Oa=["value"],Ua={key:0,class:"stats-section"},Fa={key:1,class:"matiere-stats"},Ja={key:2,class:"items-list-section"},Wa={class:"section-subtitle"},Ga={key:0,class:"inline-filters"},Ka={key:0,class:"items-list-content"},Ya={key:0,class:"empty-state"},Za={key:1,class:"items-grid"},ei={key:2,class:"pagination-container"},ti=["disabled"],si={class:"pagination-pages"},ai=["onClick"],ii=["disabled"],oi={key:3,class:"loading-state"},ni={__name:"BaseHistory",props:{title:{type:String,required:!0},listTitle:{type:String,required:!0},loadingText:{type:String,default:"Chargement..."},apiEndpoint:{type:String,required:!0},customFilters:{type:Array,default:()=>[]},navigationHandler:{type:Function,default:null},itemsPerPage:{type:Number,default:12},filteredItems:{type:Array,default:null}},emits:["data-loaded","filter-changed"],setup(H,{expose:w,emit:k}){const x=H,C=k,A=de();ye();const S=_(!0),N=_({}),g=_([]),f=_([]),j=_([]),P=_([]),z=_([]),I=_({}),D=_(""),m=_(""),d=_(""),u=_("all"),y=_(1),n=_(new Set),r=_(!0),b=T(()=>{if(!D.value)return[];const p=parseInt(D.value);return P.value.filter(c=>{const E=typeof c.theme=="object"?c.theme?.id:c.theme;let l=null;return typeof c.theme=="object"&&(l=c.theme?.matiere_id||c.theme?.matiere?.id||null),!l&&E&&I.value[E]&&(l=I.value[E].matiere_id||I.value[E].matiere),parseInt(l)===p})}),F=T(()=>{if(!m.value)return[];const p=parseInt(m.value);return z.value.filter(v=>{const c=v.notion_id??v.notion?.id??(typeof v.notion=="number"?v.notion:null);return parseInt(c)===p})}),J=T(()=>x.filteredItems?x.filteredItems:g.value),K=T(()=>Math.ceil(J.value.length/x.itemsPerPage)),se=T(()=>{const p=(y.value-1)*x.itemsPerPage,v=p+x.itemsPerPage;return J.value.slice(p,v)}),ce=T(()=>{const p=[],v=K.value,c=y.value;if(oe.value)return v<=1?[1]:[1,"...",v];if(v<=7)for(let E=1;E<=v;E++)p.push(E);else if(c<=4){for(let E=1;E<=5;E++)p.push(E);v>5&&p.push("..."),p.push(v)}else if(c>=v-3){p.push(1),v>6&&p.push("...");for(let E=v-4;E<=v;E++)E>1&&p.push(E)}else{p.push(1),p.push("...");for(let E=c-1;E<=c+1;E++)p.push(E);p.push("..."),p.push(v)}return p}),oe=_(!1),X=()=>{typeof window<"u"&&(oe.value=window.innerWidth<=768)};ee(()=>{X(),typeof window<"u"&&window.addEventListener("resize",X)}),je(()=>{typeof window<"u"&&window.removeEventListener("resize",X)});const V=T(()=>j.value||[]),U=async()=>{try{const[p,v,c,E]=await Promise.all([O.get("/api/matieres/user_matieres/"),O.get("/api/themes/notions-pour-utilisateur/",{timeout:2e4}).catch(()=>O.get("/api/themes/notions-pour-utilisateur/")),ze({}).catch(()=>O.get("/api/notions/pour-utilisateur/",{timeout:2e4})),re({})]);let l=[];p?.data?.matieres_disponibles?l=p.data.matieres_disponibles:p?.data?.data?l=p.data.data:Array.isArray(p?.data)&&(l=p.data);let o=[];c?.data?.notions_disponibles?o=c.data.notions_disponibles:c?.data?.data?o=c.data.data:Array.isArray(c?.data)?o=c.data:c?.data?.results&&(o=c.data.results);const s=v?.data?.themes||[],h=v?.data?.notions||[],M={};s.forEach(ie=>{const R=ie.matiere_id||ie.matiere&&(ie.matiere.id||ie.matiere);M[ie.id]={matiere_id:R,matiere:R}}),I.value=M,Array.isArray(h)&&h.length>0&&(o=h);const W=Array.isArray(E?.data)?E.data:E?.results||[];j.value=Array.isArray(l)?l:[],P.value=Array.isArray(o)?o:[],z.value=Array.isArray(W)?W:[],await Pe()}catch{try{const[v,c,E]=await Promise.all([Te({}),ze({}),re({})]);j.value=Array.isArray(v?.data)?v.data:v?.results||[],P.value=Array.isArray(c?.data)?c.data:c?.results||[],z.value=Array.isArray(E?.data)?E.data:E?.results||[],await Pe()}catch{}}},Y=async()=>{S.value=!0;try{const p={};D.value&&(p.matiere=D.value),m.value&&(p.notion=m.value),d.value&&(p.chapitre=d.value);const c=(await O.get(x.apiEndpoint,{params:p})).data;N.value=c.global_stats||{},g.value=c.quiz_list||c.exercice_list||[],f.value=c.matiere_stats||[],C("data-loaded",c)}catch{}finally{S.value=!1}},ae=async()=>{if(m.value="",d.value="",ve(),D.value&&b.value.length===0)try{const p=await O.get("/api/themes/notions-pour-utilisateur/",{params:{matiere:D.value}}),v=p?.data?.themes||[],c=p?.data?.notions||[],E={};v.forEach(h=>{const M=h.matiere_id||h.matiere&&(h.matiere.id||h.matiere);E[h.id]={matiere_id:M,matiere:M}}),I.value={...I.value,...E};let l=c;if(!Array.isArray(l)||l.length===0){const h=await O.get("/api/notions/pour-utilisateur/",{params:{matiere:D.value}});h?.data?.notions_disponibles?l=h.data.notions_disponibles:h?.data?.data?l=h.data.data:Array.isArray(h?.data)?l=h.data:h?.data?.results&&(l=h.data.results)}const o=P.value.map(h=>h.id),s=l.filter(h=>!o.includes(h.id));P.value=[...P.value,...s]}catch{}Y(),C("filter-changed",{matiere:D.value,notion:m.value,chapitre:d.value})},Ae=async()=>{if(d.value="",ve(),m.value)try{let p=await Le(m.value),v=[];if(Array.isArray(p?.data)?v=p.data:p?.data?.results&&(v=p.data.results),v.length===0){const c=await re({notion:m.value});Array.isArray(c?.data)?v=c.data:c?.data?.results&&(v=c.data.results)}if(v.length===0){const c=await O.get(`/api/notions/${m.value}/chapitres/`);Array.isArray(c?.data)?v=c.data:c?.data?.results&&(v=c.data.results)}if(v.length>0){const c=z.value.map(l=>l.id),E=v.filter(l=>!c.includes(l.id));z.value=[...z.value,...E]}}catch{}Y(),C("filter-changed",{matiere:D.value,notion:m.value,chapitre:d.value})},ue=()=>{ve(),Y(),C("filter-changed",{matiere:D.value,notion:m.value,chapitre:d.value})},be=p=>{n.value.has(p)?n.value.delete(p):n.value.add(p)},$e=p=>n.value.has(p),Ie=()=>{r.value=!r.value},ke=p=>{x.navigationHandler&&x.navigationHandler(p)},me=p=>{typeof p=="number"&&p>=1&&p<=K.value&&(y.value=p)},ve=()=>{y.value=1},Ee=p=>new Date(p).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),we=p=>{const v=Math.floor(p/60),c=p%60;return`${v}:${c.toString().padStart(2,"0")}`};return ee(async()=>{if(A.isLoading||!A.isAuthenticated&&!A.id){let p=0;for(;(A.isLoading||!A.isAuthenticated)&&p<30;)await new Promise(v=>setTimeout(v,100)),p++}await U(),await Y()}),w({formatDate:Ee,formatTime:we,toggleItemDetails:be,isItemExpanded:$e,navigateToItem:ke,selectedCustomFilter:u,resetPagination:ve}),(p,v)=>(t(),a("div",Na,[e("div",qa,[e("h3",La,i(H.title),1),e("div",Xa,[Z((t(),a("select",{"onUpdate:modelValue":v[0]||(v[0]=c=>D.value=c),onChange:ae,class:"filter-select",key:"matieres-"+V.value.length},[v[5]||(v[5]=e("option",{value:""},"Toutes les matières",-1)),(t(!0),a(L,null,B(V.value,c=>(t(),a("option",{key:`matiere-${c.id}`,value:c.id},i(c.titre||c.nom),9,Qa))),128))],32)),[[pe,D.value]]),Z(e("select",{"onUpdate:modelValue":v[1]||(v[1]=c=>m.value=c),onChange:Ae,class:"filter-select",disabled:!D.value},[v[6]||(v[6]=e("option",{value:""},"Toutes les notions",-1)),(t(!0),a(L,null,B(b.value,c=>(t(),a("option",{key:c.id,value:c.id},i(c.titre),9,Ba))),128))],40,Va),[[pe,m.value]]),Z(e("select",{"onUpdate:modelValue":v[2]||(v[2]=c=>d.value=c),onChange:ue,class:"filter-select",disabled:!m.value},[v[7]||(v[7]=e("option",{value:""},"Tous les chapitres",-1)),(t(!0),a(L,null,B(F.value,c=>(t(),a("option",{key:c.id,value:c.id},i(c.titre),9,Oa))),128))],40,Ha),[[pe,d.value]])])]),S.value?$("",!0):(t(),a("div",Ua,[fe(p.$slots,"global-stats",{stats:N.value,loading:S.value},void 0,!0)])),!S.value&&f.value.length>0?(t(),a("div",Fa,[fe(p.$slots,"matiere-stats",{stats:f.value},void 0,!0)])):$("",!0),S.value?$("",!0):(t(),a("div",Ja,[e("div",{class:"items-list-header",onClick:Ie},[e("h4",Wa,i(H.listTitle)+" ("+i(J.value.length)+")",1),H.customFilters&&H.customFilters.length>0?(t(),a("div",Ga,[fe(p.$slots,"custom-filters",{filters:H.customFilters,selected:u.value},void 0,!0)])):$("",!0),e("button",{class:Q(["section-toggle",{expanded:r.value}])},v[8]||(v[8]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"6,9 12,15 18,9"})],-1)]),2)]),r.value?(t(),a("div",Ka,[J.value.length===0?(t(),a("div",Ya,[fe(p.$slots,"empty-state",{},()=>[v[9]||(v[9]=e("p",null,"Aucun élément trouvé avec ces filtres",-1))],!0)])):(t(),a("div",Za,[fe(p.$slots,"items-list",{items:se.value,toggleDetails:be,isExpanded:$e,navigateToItem:ke},void 0,!0)])),K.value>1?(t(),a("div",ei,[e("button",{onClick:v[3]||(v[3]=c=>me(y.value-1)),disabled:y.value<=1,class:"pagination-btn prev",title:"Précédent","aria-label":"Précédent"},v[10]||(v[10]=[e("span",{class:"pagination-icon"},"‹",-1),e("span",{class:"pagination-label"},"Précédent",-1)]),8,ti),e("div",si,[(t(!0),a(L,null,B(ce.value,c=>(t(),a("button",{key:c,onClick:E=>me(c),class:Q(["pagination-page",{active:c===y.value}])},i(c),11,ai))),128))]),e("button",{onClick:v[4]||(v[4]=c=>me(y.value+1)),disabled:y.value>=K.value,class:"pagination-btn next",title:"Suivant","aria-label":"Suivant"},v[11]||(v[11]=[e("span",{class:"pagination-label"},"Suivant",-1),e("span",{class:"pagination-icon"},"›",-1)]),8,ii)])):$("",!0)])):$("",!0)])),S.value?(t(),a("div",oi,[v[12]||(v[12]=e("div",{class:"spinner"},null,-1)),e("p",null,i(H.loadingText),1)])):$("",!0)]))}},li=te(ni,[["__scopeId","data-v-7e837065"]]),ri={class:"stats-grid"},di={class:"stat-card exercice-completed"},ci={class:"stat-value"},ui={class:"stat-card exercice-correct"},vi={class:"stat-value"},pi={class:"stat-card exercice-percentage"},mi={class:"stat-value"},_i={class:"stat-card exercice-notions"},hi={class:"stat-value"},fi={class:"matiere-grid"},gi={class:"matiere-name"},yi={class:"matiere-info"},bi={class:"matiere-average"},$i={class:"matiere-count"},ki={class:"inline-mastery-filters"},wi=["onClick","title","aria-label"],Ci={class:"inline-mastery-icon"},xi={class:"inline-mastery-label"},Si=["onClick"],Pi={class:"exercice-card-title-section"},zi=["onClick","title"],Ai={class:"exercice-breadcrumb-compact"},Ii={class:"exercice-card-actions"},Ei={key:0,class:"exercice-card-details"},Di={class:"exercice-breadcrumb"},ji={class:"breadcrumb-item"},Ti={class:"breadcrumb-item"},Mi={class:"breadcrumb-item"},Ri={class:"exercice-meta"},Ni={class:"exercice-date"},qi={key:0,class:"exercice-time"},Li={key:1,class:"exercice-points"},Xi={__name:"ExercicesHistory",setup(H,{expose:w}){const k=ye(),x=_(null),C=[{value:"all",label:"Tous",icon:"",class:"all"},{value:"correct",label:"Réussis",icon:"✅",class:"correct"},{value:"incorrect",label:"Ratés",icon:"❌",class:"incorrect"}],A=_("all"),S=_([]),N=T(()=>{let m=S.value;return A.value!=="all"&&(m=m.filter(d=>{switch(A.value){case"correct":return d.est_correct===!0;case"incorrect":return d.est_correct===!1;default:return!0}})),m}),g=m=>{S.value=m.exercice_list||[]},f=m=>{},j=m=>m?"status-correct":"status-incorrect",P=async m=>{try{const d=m.exercice_id;await k.push({name:"ExerciceDetail",params:{exerciceId:String(d)}})}catch{}},z=m=>new Date(m).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),I=m=>{const d=Math.floor(m/60),u=m%60;return`${d}:${u.toString().padStart(2,"0")}`},D=m=>{A.value=m};return w({updateSelectedMastery:D}),(m,d)=>(t(),Se(li,{ref_key:"baseHistoryRef",ref:x,title:"🧭 Historique des Exercices","list-title":"📝 Exercices effectués","loading-text":"Chargement des exercices...","api-endpoint":"/api/suivis/exercices/stats/","custom-filters":C,"navigation-handler":P,"items-per-page":6,"filtered-items":N.value,onDataLoaded:g,onFilterChanged:f},{"global-stats":le(({stats:u})=>[e("div",ri,[e("div",di,[d[0]||(d[0]=e("span",{class:"stat-label"},"Exercices effectués",-1)),e("span",ci,i(u.completed||0),1)]),e("div",ui,[d[1]||(d[1]=e("span",{class:"stat-label"},"Exercices réussis",-1)),e("span",vi,i(u.correct||0),1)]),e("div",pi,[d[2]||(d[2]=e("span",{class:"stat-label"},"Taux de réussite",-1)),e("span",mi,i(u.percentage||0)+"%",1)]),e("div",_i,[d[3]||(d[3]=e("span",{class:"stat-label"},"Notions maîtrisées",-1)),e("span",hi,i(u.masteredNotions||0),1)])])]),"matiere-stats":le(({stats:u})=>[d[4]||(d[4]=e("h4",{class:"section-subtitle"},"📊 Moyennes par matière",-1)),e("div",fi,[(t(!0),a(L,null,B(u,y=>(t(),a("div",{key:y.id,class:"matiere-card"},[e("div",gi,i(y.titre),1),e("div",yi,[e("span",bi,i(y.average)+"/10",1),e("span",$i,i(y.exercice_count)+" exercices",1)])]))),128))])]),"custom-filters":le(({filters:u,selected:y})=>[e("div",ki,[(t(!0),a(L,null,B(u,n=>(t(),a("button",{key:n.value,onClick:ge(r=>D(n.value),["stop"]),class:Q(["inline-mastery-btn",n.class,{active:A.value===n.value}]),title:n.label,"aria-label":n.label},[e("span",Ci,i(n.icon),1),e("span",xi,i(n.label),1)],10,wi))),128))])]),"items-list":le(({items:u,toggleDetails:y,isExpanded:n,navigateToItem:r})=>[(t(!0),a(L,null,B(u,b=>(t(),a("div",{key:b.id,class:Q(["exercice-card",{correct:b.est_correct,incorrect:!b.est_correct}])},[e("div",{class:"exercice-card-header",onClick:F=>y(b.id)},[e("div",Pi,[e("h5",{class:"exercice-card-title clickable-title",onClick:ge(F=>r(b),["stop"]),title:"Accéder à l'exercice: "+b.exercice_titre},[G(i(b.exercice_titre)+" ",1),d[5]||(d[5]=e("svg",{class:"navigation-icon",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M7 17l9.2-9.2M17 17V7H7"})],-1))],8,zi),e("div",Ai,i(b.matiere.titre)+" → "+i(b.notion.titre),1)]),e("div",Ii,[e("div",{class:Q(["exercice-status",j(b.est_correct)])},i(b.est_correct?"✅":"❌"),3),e("button",{class:Q(["expand-toggle",{expanded:n(b.id)}])},d[6]||(d[6]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"6,9 12,15 18,9"})],-1)]),2)])],8,Si),n(b.id)?(t(),a("div",Ei,[e("div",Di,[e("span",ji,i(b.matiere.titre),1),d[7]||(d[7]=e("span",{class:"breadcrumb-separator"},"→",-1)),e("span",Ti,i(b.notion.titre),1),d[8]||(d[8]=e("span",{class:"breadcrumb-separator"},"→",-1)),e("span",Mi,i(b.chapitre.titre),1)]),e("div",Ri,[e("span",Ni,i(z(b.date_creation)),1),b.temps_seconde?(t(),a("span",qi,i(I(b.temps_seconde)),1)):$("",!0),b.points_obtenus?(t(),a("span",Li,i(b.points_obtenus)+" points ",1)):$("",!0)])])):$("",!0)],2))),128))]),"empty-state":le(()=>d[9]||(d[9]=[e("p",null,"Aucun exercice trouvé avec ces filtres",-1),e("p",{class:"empty-hint"},"Essayez de modifier vos filtres ou commencez à faire des exercices !",-1)])),_:1},8,["filtered-items"]))}},Qi=te(Xi,[["__scopeId","data-v-6df03229"]]),Vi={class:"daily-objectives-card"},Bi={key:0,class:"current-objective"},Hi={class:"objective-icon"},Oi={class:"objective-content"},Ui={class:"objective-text"},Fi={class:"objective-progress"},Ji={class:"progress-bar"},Wi={class:"progress-text"},Gi={key:1,class:"no-objective"},Ki={key:2,class:"completion-badge"},Yi={class:"objectives-list"},Zi={class:"objective-info"},eo={class:"objective-icon-small"},to={class:"objective-details"},so={class:"objective-text-small"},ao={class:"objective-description"},io={class:"objective-reward"},oo={class:"objective-status"},no={class:"progress-info"},lo={class:"progress-bar-modal"},ro={key:0,class:"status-completed"},co={class:"modal-footer"},uo={class:"daily-summary"},vo={class:"summary-stat"},po={class:"stat-value"},mo={class:"summary-stat"},_o={class:"stat-value"},ho={__name:"DailyObjectives",setup(H){const w=_(!1),{currentObjective:k,unlockedObjectivesList:x,allObjectives:C,loadTodayStats:A,isInitialized:S,simulateQuizEasy:N,simulateQuizMedium:g,simulateQuizHard:f,simulateQuizPerfect:j,simulateExerciseCompleted:P,simulateQuizStreak:z}=tt(),I=T(()=>x.value.filter(X=>X.isCompleted).length),D=T(()=>x.value.filter(X=>X.isCompleted).reduce((X,V)=>X+V.xpReward,0)),m=()=>{w.value=!0},d=()=>{w.value=!1},u=T(()=>{if(!k.value)return 0;const X=k.value.progress,V=k.value.target;return Math.min(X/V*100,100)}),y=X=>X>=100?"completed":X>=75?"almost-done":X>=25?"half-way":X>0?"starting":"",n=()=>N(),r=()=>g(),b=()=>f(),F=()=>j(),J=()=>P(),K=()=>z(Math.floor(Math.random()*8)+1),se=X=>{A(),setTimeout(()=>{k.value},100)},ce=X=>{},oe=X=>{};return ee(()=>{window.addEventListener("dailyObjectiveProgress",se),window.addEventListener("objectiveUnlocked",ce),window.addEventListener("dailyObjectiveCompleted",oe)}),je(()=>{window.removeEventListener("dailyObjectiveProgress",se),window.removeEventListener("objectiveUnlocked",ce),window.removeEventListener("dailyObjectiveCompleted",oe)}),window.testDailyObjectives={quizEasy:n,quizMedium:r,quizHard:b,quizPerfect:F,exerciseCompleted:J,quizStreak:K},(X,V)=>(t(),a(L,null,[e("div",Vi,[e("div",{class:"objective-header"},[V[1]||(V[1]=e("div",{class:"objective-title"},"🎯 Défi du jour",-1)),e("button",{class:"see-more-btn",onClick:m}," Voir tous les défis ")]),q(S)&&q(k)?(t(),a("div",Bi,[e("div",Hi,i(q(k).icon),1),e("div",Oi,[e("div",Ui,i(q(k).text),1),e("div",Fi,[e("div",Ji,[e("div",{class:Q(["progress-fill",y(u.value)]),style:xe({width:u.value+"%"})},null,6)]),e("div",Wi,i(q(k).progress)+" / "+i(q(k).target),1)])])])):(t(),a("div",Gi,[q(S)?(t(),a(L,{key:0},[G(" 🎉 Tous les défis du jour sont terminés ! Revenez demain pour de nouveaux défis. ")],64)):(t(),a(L,{key:1},[G(" ⏳ Chargement des défis du jour... ")],64))])),q(k)&&q(k).isCompleted?(t(),a("div",Ki," ✅ Défi complété ! +"+i(q(k).xpReward)+" XP ",1)):$("",!0)]),w.value?(t(),a("div",{key:0,class:"modal-overlay",onClick:d},[e("div",{class:"modal-content",onClick:V[0]||(V[0]=ge(()=>{},["stop"]))},[e("div",{class:"modal-header"},[V[2]||(V[2]=e("h3",null,"🎯 Vos défis journaliers",-1)),e("button",{class:"close-btn",onClick:d},"×")]),e("div",Yi,[(t(!0),a(L,null,B(q(C),(U,Y)=>(t(),a("div",{key:Y,class:Q(["objective-item",{completed:U.isCompleted,locked:!U.isUnlocked}])},[e("div",Zi,[e("div",eo,i(U.icon),1),e("div",to,[e("div",so,i(U.name),1),e("div",ao,i(U.text),1),e("div",io,"+"+i(U.xpReward)+" XP",1)])]),e("div",oo,[e("div",no,i(U.progress)+" / "+i(U.target),1),e("div",lo,[e("div",{class:Q(["progress-fill-modal",{completed:U.isCompleted}]),style:xe({width:U.percentage+"%"})},null,6)]),U.isCompleted?(t(),a("div",ro," ✅ Terminé ")):$("",!0)])],2))),128))]),e("div",co,[e("div",uo,[e("div",vo,[V[3]||(V[3]=e("span",{class:"stat-label"},"Défis complétés :",-1)),e("span",po,i(I.value)+" / "+i(q(C).length),1)]),e("div",mo,[V[4]||(V[4]=e("span",{class:"stat-label"},"XP gagnés aujourd'hui :",-1)),e("span",_o,"+"+i(D.value),1)])]),V[5]||(V[5]=e("p",{class:"modal-note"}," Tous les défis se réinitialisent chaque jour à minuit. Bonne chance ! ",-1))])])])):$("",!0),ne(Ve)],64))}},fo=te(ho,[["__scopeId","data-v-a56e4f19"]]),go={class:"streak-test-container"},yo={class:"status-grid"},bo={class:"status-card"},$o={class:"status-content"},ko={class:"status-value"},wo={class:"status-card"},Co={class:"status-content"},xo={class:"status-value"},So={class:"status-card"},Po={class:"status-content"},zo={class:"status-value"},Ao={class:"status-card"},Io={class:"status-content"},Eo={class:"simulation-section"},Do={class:"simulation-buttons"},jo={key:0,class:"test-results"},To={class:"results-list"},Mo={class:"result-time"},Ro={class:"result-message"},No={__name:"StreakTestButton",setup(H){const w=de(),{currentStreak:k,isStreakCheckedToday:x,checkDailyStreak:C,resetStreak:A,initializeStreak:S}=qe(),{updateUserXPInstantly:N}=Be(),g=_([]),f=(n,r="info")=>{const b=new Date().toLocaleTimeString();g.value.unshift({timestamp:b,message:n,type:r}),g.value.length>8&&(g.value=g.value.slice(0,8))},j=n=>{try{f(`🎭 Simulation du jour ${n}...`,"info");const r=new Date,b=new Date(r);b.setDate(r.getDate()-1);const F=b.toISOString().split("T")[0],J=n-1;localStorage.setItem("lastLoginDate",F),localStorage.setItem("currentStreak",J.toString()),localStorage.removeItem("streakCheckedToday"),k.value=J,x.value=!1,f(`✅ Streak de ${n} jours simulé (dernière connexion: ${F})`,"success"),setTimeout(()=>{I()},500)}catch(r){f(`❌ Erreur simulation jour ${n}: ${r.message}`,"error")}},P=()=>{try{f("💔 Simulation rupture de streak...","warning");const n=new Date,r=new Date(n);r.setDate(n.getDate()-3);const b=r.toISOString().split("T")[0];localStorage.setItem("lastLoginDate",b),localStorage.setItem("currentStreak","0"),localStorage.removeItem("streakCheckedToday"),k.value=0,x.value=!1,f("✅ Rupture de streak simulée (3 jours d'écart)","warning"),setTimeout(()=>{I()},500)}catch(n){f(`❌ Erreur simulation rupture: ${n.message}`,"error")}},z=()=>{try{f("🔄 Reset de la simulation...","info");const n=new Date().toISOString().split("T")[0];localStorage.setItem("lastLoginDate",n),localStorage.setItem("currentStreak","0"),localStorage.removeItem("streakCheckedToday"),k.value=0,x.value=!1,f("✅ Simulation remise à aujourd'hui (streak: 0)","success")}catch(n){f(`❌ Erreur reset simulation: ${n.message}`,"error")}},I=async()=>{try{f("🔄 Vérification du streak...","info");const n=await C();n.success?n.alreadyChecked?f("✅ Streak déjà vérifié aujourd'hui","success"):f(`🎉 Streak: ${n.streakDays} jours, +${n.xpGained} XP`,"success"):f(`❌ Erreur: ${n.reason||"inconnue"}`,"error")}catch(n){f(`❌ Erreur: ${n.message}`,"error")}},D=async()=>{try{f("➕ Test +5 XP...","info");const n=w.xp||0;if((await N(5,"test_manual")).success){const b=w.xp||0;f(`✅ XP: ${n} → ${b} (+5)`,"success")}else f("❌ Échec mise à jour XP","error")}catch(n){f(`❌ Erreur: ${n.message}`,"error")}},m=async()=>{try{f("➖ Test -5 XP...","info");const n=w.xp||0;if((await N(-5,"test_manual_decrease")).success){const b=w.xp||0;f(`✅ XP: ${n} → ${b} (-5)`,"success")}else f("❌ Échec diminution XP","error")}catch(n){f(`❌ Erreur: ${n.message}`,"error")}},d=()=>{try{A(),f("🗑️ Streak remis à zéro","warning")}catch(n){f(`❌ Erreur reset: ${n.message}`,"error")}},u=async()=>{try{f("🔄 Rafraîchissement...","info"),S(),f("✅ Données rafraîchies","success")}catch(n){f(`❌ Erreur: ${n.message}`,"error")}},y=()=>{g.value=[]};return ee(()=>{f("🚀 Test Badges & Streak chargé","info")}),(n,r)=>(t(),a("div",go,[r[18]||(r[18]=e("div",{class:"test-header"},[e("h3",null,"🧪 Test Badges & Streak"),e("p",{class:"test-subtitle"},"Interface de test pour administrateur")],-1)),e("div",yo,[e("div",bo,[r[8]||(r[8]=e("span",{class:"status-icon"},"🔥",-1)),e("div",$o,[r[7]||(r[7]=e("span",{class:"status-label"},"Streak",-1)),e("span",ko,i(q(k))+" jours",1)])]),e("div",wo,[r[10]||(r[10]=e("span",{class:"status-icon"},"⭐",-1)),e("div",Co,[r[9]||(r[9]=e("span",{class:"status-label"},"XP",-1)),e("span",xo,i(q(w).xp||0),1)])]),e("div",So,[r[12]||(r[12]=e("span",{class:"status-icon"},"🏆",-1)),e("div",Po,[r[11]||(r[11]=e("span",{class:"status-label"},"Niveau",-1)),e("span",zo,i(q(w).level||0),1)])]),e("div",Ao,[r[14]||(r[14]=e("span",{class:"status-icon"},"📅",-1)),e("div",Io,[r[13]||(r[13]=e("span",{class:"status-label"},"Vérifié",-1)),e("span",{class:Q(["status-value",{checked:q(x)}])},i(q(x)?"Oui":"Non"),3)])])]),e("div",Eo,[r[15]||(r[15]=e("h4",null,"🎭 Simulation de Jours",-1)),r[16]||(r[16]=e("p",{class:"simulation-info"},"Simulez différents jours pour tester le streak",-1)),e("div",Do,[e("button",{onClick:r[0]||(r[0]=b=>j(1)),class:"sim-btn day-1"}," 📅 Jour 1 "),e("button",{onClick:r[1]||(r[1]=b=>j(2)),class:"sim-btn day-2"}," 📅 Jour 2 "),e("button",{onClick:r[2]||(r[2]=b=>j(3)),class:"sim-btn day-3"}," 📅 Jour 3 "),e("button",{onClick:r[3]||(r[3]=b=>j(4)),class:"sim-btn day-4"}," 📅 Jour 4 "),e("button",{onClick:r[4]||(r[4]=b=>j(5)),class:"sim-btn day-5"}," 📅 Jour 5 "),e("button",{onClick:r[5]||(r[5]=b=>j(7)),class:"sim-btn day-7"}," 📅 Jour 7 "),e("button",{onClick:r[6]||(r[6]=b=>j(10)),class:"sim-btn day-10"}," 📅 Jour 10 ")]),e("div",{class:"simulation-controls"},[e("button",{onClick:P,class:"sim-btn break"}," 💔 Casser le Streak "),e("button",{onClick:z,class:"sim-btn reset"}," 🔄 Reset Simulation ")])]),e("div",{class:"test-actions"},[e("button",{onClick:I,class:"test-btn primary"}," 🔄 Vérifier Streak "),e("button",{onClick:D,class:"test-btn success"}," ➕ +5 XP "),e("button",{onClick:m,class:"test-btn danger"}," ➖ -5 XP "),e("button",{onClick:d,class:"test-btn warning"}," 🗑️ Reset "),e("button",{onClick:u,class:"test-btn info"}," 🔄 Refresh ")]),g.value.length>0?(t(),a("div",jo,[e("div",{class:"results-header"},[r[17]||(r[17]=e("h4",null,"📊 Résultats des tests",-1)),e("button",{onClick:y,class:"clear-btn"},"🗑️")]),e("div",To,[(t(!0),a(L,null,B(g.value,(b,F)=>(t(),a("div",{key:F,class:Q(["result-item",b.type])},[e("span",Mo,i(b.timestamp),1),e("span",Ro,i(b.message),1)],2))),128))])])):$("",!0)]))}},qo=te(No,[["__scopeId","data-v-d8c0f382"]]),Lo={class:"dashboard-content"},Xo={class:"dashboard-center-top"},Qo={key:0,class:"dashboard-spinner"},Vo={key:1},Bo={class:"section leaderboard-section"},Ho={class:"leaderboard-grid"},Oo={class:"leaderboard-container"},Uo={class:"level-container"},Fo={key:0},Jo={key:1},Wo={key:2,class:"dashboard-spinner"},Go={key:3,class:"section"},Ko={__name:"DashboardStudent",setup(H){const w=de();He(),ye();const k=_({done:0,acquired:0,not_acquired:0}),x=_(!0),C=_([]),A=_([]),S=_([]),N=_({}),g=_({}),f=_([]),j=_(null);T(()=>C.value.length?[...C.value].sort((I,D)=>new Date(D.date_creation)-new Date(I.date_creation))[0]:null);function P(){N.value=Object.fromEntries(A.value.map(z=>[z.id,z])),g.value=Object.fromEntries(S.value.map(z=>[z.id,z]))}return ee(async()=>{try{const[z,I,D,m,d,u]=await Promise.all([Ye({}),re({}),Ze(),Te(),Oe().catch(()=>null),Ue().catch(()=>null)]),y=r=>Array.isArray(r)?r:r?.results||[];A.value=y(z),S.value=y(I),C.value=y(D?.data),f.value=y(m?.data??m),j.value=u?.data?.data||null;const n=d?.data?.data;n&&(w.xp=n.xp??w.xp,w.level=n.level??w.level,w.xp_to_next=n.xp_to_next??n.next_level_xp-n.xp),P(),k.value.done=C.value.length,k.value.acquired=C.value.filter(r=>r.est_correct===!0).length,k.value.not_acquired=C.value.filter(r=>r.est_correct===!1).length}catch{}x.value=!1}),(z,I)=>(t(),a("div",Lo,[ne(Is),e("div",Xo,[q(w).isLoading?(t(),a("div",Qo,I[0]||(I[0]=[e("span",{class:"spinner"},null,-1)]))):(t(),a("h1",Vo," Bienvenue "+i(q(w).firstName)+" sur votre tableau de bord ",1))]),e("div",Bo,[e("div",Ho,[e("div",Oo,[ne(ss)]),e("div",Uo,[ne(Ps),ne(fo)])])]),x.value?$("",!0):(t(),a("div",Fo,[ne(Ra)])),x.value?$("",!0):(t(),a("div",Jo,[ne(Qi)])),x.value?(t(),a("div",Wo,I[1]||(I[1]=[e("span",{class:"spinner"},null,-1)]))):$("",!0),q(w).isAdmin?(t(),a("div",Go,[I[2]||(I[2]=e("div",{class:"section-header"},[e("h3",{class:"section-title"},"🧪 Tests (Admin uniquement)")],-1)),ne(qo)])):$("",!0)]))}},Yo=te(Ko,[["__scopeId","data-v-9913241e"]]),Zo={class:"parent-dashboard"},en={class:"add-child"},tn=["disabled"],sn={key:0,class:"hint"},an={class:"create-child"},on={class:"form-row"},nn={class:"form-row"},ln=["disabled"],rn={key:0,class:"hint"},dn={key:1,class:"temp-pass"},cn={key:0,class:"loading"},un={key:1},vn={key:0,class:"empty"},pn={key:1,class:"children-grid"},mn={class:"child-header"},_n={class:"avatar"},hn={class:"child-info"},fn={class:"name"},gn={key:0,class:"flag"},yn={class:"meta"},bn={key:0},$n={class:"xp"},kn={class:"xp-value"},wn={class:"level"},Cn={class:"child-body"},xn={class:"metrics-grid"},Sn={class:"metric"},Pn={class:"bar"},zn={class:"hint"},An={class:"metric small"},In={class:"kpi"},En={class:"metric small ok"},Dn={class:"kpi"},jn={class:"metric small ko"},Tn={class:"kpi"},Mn={key:0,class:"last-activity"},Rn={class:"activity-line"},Nn={class:"activity-title"},qn={key:0,class:"activity-meta"},Ln={class:"actions"},Xn=["onClick"],Qn=["onClick","disabled"],Vn={__name:"DashboardParent",setup(H){const w=_(!0),k=_([]),x=ye(),C=_(""),A=_(!1),S=_(""),N=_(null),g=_(!1),f=_(""),j=_(""),P=_({first_name:"",last_name:"",email:""});function z(y){if(!y)return"E";const n=String(y).trim().split(/\s+/);return n.length===1?n[0].substring(0,2).toUpperCase():(n[0].substring(0,1)+n[1].substring(0,1)).toUpperCase()}function I(y){x.push({name:"ChildOverview",params:{childId:String(y)}})}ee(async()=>{try{const n=(await Ne())?.data?.data||{};k.value=n.children||[]}catch{k.value=[]}finally{w.value=!1}});async function D(){try{const n=(await Ne())?.data?.data||{};k.value=n.children||[]}catch{k.value=[]}}async function m(){S.value="";const y=String(C.value||"").trim();if(!y){S.value="Renseignez l'email de l'élève";return}A.value=!0;try{await Fe({email:y}),C.value="",S.value="Élève ajouté ✅",await D()}catch{S.value="Impossible d'ajouter cet élève"}finally{A.value=!1,setTimeout(()=>{S.value=""},2500)}}async function d(y){N.value=y;try{await Je(y),await D()}catch{}N.value=null}async function u(){f.value="",j.value="";const y={first_name:String(P.value.first_name||"").trim(),last_name:String(P.value.last_name||"").trim(),email:String(P.value.email||"").trim().toLowerCase()};if(!y.first_name||!y.last_name||!y.email){f.value="Renseignez prénom, nom et email";return}g.value=!0;try{const r=(await O.post("/api/users/me/children/create/",y))?.data?.data||{};j.value=r.temp_password||"",f.value="Compte créé et lié ✅",P.value={first_name:"",last_name:"",email:""},await D()}catch{f.value="Création impossible (email déjà utilisé?)"}finally{g.value=!1,setTimeout(()=>{f.value=""},3e3)}}return(y,n)=>(t(),a("div",Zo,[n[13]||(n[13]=e("div",{class:"header"},[e("h1",null,"Tableau de bord Parent"),e("p",{class:"subtitle"},"Suivez la progression de vos enfants, simplement.")],-1)),e("div",en,[Z(e("input",{"onUpdate:modelValue":n[0]||(n[0]=r=>C.value=r),type:"email",placeholder:"Email de l'élève",class:"input"},null,512),[[Ce,C.value]]),e("button",{class:"btn",disabled:A.value,onClick:m},"Ajouter",8,tn),S.value?(t(),a("span",sn,i(S.value),1)):$("",!0)]),e("div",an,[e("details",null,[n[5]||(n[5]=e("summary",null,"Créer un compte pour un enfant",-1)),e("div",on,[Z(e("input",{"onUpdate:modelValue":n[1]||(n[1]=r=>P.value.first_name=r),class:"input",placeholder:"Prénom"},null,512),[[Ce,P.value.first_name]]),Z(e("input",{"onUpdate:modelValue":n[2]||(n[2]=r=>P.value.last_name=r),class:"input",placeholder:"Nom"},null,512),[[Ce,P.value.last_name]])]),e("div",nn,[Z(e("input",{"onUpdate:modelValue":n[3]||(n[3]=r=>P.value.email=r),class:"input",placeholder:"Email"},null,512),[[Ce,P.value.email]])]),e("button",{class:"btn",disabled:g.value,onClick:u},"Créer le compte",8,ln),f.value?(t(),a("div",rn,i(f.value),1)):$("",!0),j.value?(t(),a("div",dn,[n[4]||(n[4]=G("Mot de passe temporaire: ")),e("code",null,i(j.value),1)])):$("",!0)])]),w.value?(t(),a("div",cn,n[6]||(n[6]=[e("span",{class:"spinner"},null,-1)]))):(t(),a("div",un,[k.value.length===0?(t(),a("div",vn,n[7]||(n[7]=[e("p",null,"Aucun enfant rattaché pour le moment.",-1)]))):(t(),a("div",pn,[(t(!0),a(L,null,B(k.value,r=>(t(),a("div",{class:"child-card",key:r.id},[e("div",mn,[e("div",_n,i(z(r.display_name)),1),e("div",hn,[e("div",fn,[r.pays_flag?(t(),a("span",gn,i(r.pays_flag),1)):$("",!0),G(" "+i(r.display_name),1)]),e("div",yn,[r.niveau?(t(),a("span",bn,i(r.niveau),1)):$("",!0)])]),e("div",$n,[e("div",kn,i(r.xp)+" XP",1),e("div",wn,"Niveau "+i(r.level),1)])]),e("div",Cn,[e("div",xn,[e("div",Sn,[n[8]||(n[8]=e("div",{class:"label"},"Objectif hebdo",-1)),e("div",Pn,[e("div",{class:"fill",style:xe({width:(r.metrics?.weekly_progress||0)+"%"})},null,4)]),e("div",zn,i(r.metrics?r.metrics.weekly_done+" / "+r.metrics.weekly_goal:"—"),1)]),e("div",An,[e("div",In,i(r.metrics?.done_total??"—"),1),n[9]||(n[9]=e("div",{class:"kpi-label"},"Exercices",-1))]),e("div",En,[e("div",Dn,i(r.metrics?.acquired_count??"—"),1),n[10]||(n[10]=e("div",{class:"kpi-label"},"Acquis",-1))]),e("div",jn,[e("div",Tn,i(r.metrics?.not_acquired_count??"—"),1),n[11]||(n[11]=e("div",{class:"kpi-label"},"À revoir",-1))])]),r.last_activity?(t(),a("div",Mn,[n[12]||(n[12]=e("div",{class:"label"},"Dernière activité",-1)),e("div",Rn,[e("span",Nn,i(r.last_activity.exercice_title),1),r.last_activity.chapitre_title?(t(),a("span",qn,"• "+i(r.last_activity.chapitre_title),1)):$("",!0)])])):$("",!0),e("div",Ln,[e("button",{class:"btn",onClick:b=>I(r.id)},"Voir détails",8,Xn),e("button",{class:"btn secondary",onClick:b=>d(r.id),disabled:N.value===r.id},"Retirer",8,Qn)])])]))),128))]))]))]))}},Bn=te(Vn,[["__scopeId","data-v-bec17232"]]),sl={__name:"Dashboard",setup(H){const w=de(),k=T(()=>w.role==="parent"?Bn:Yo);return(x,C)=>(t(),Se(Xe,null,{default:le(()=>[(t(),Se(Ke(k.value)))]),_:1}))}};export{sl as default};
