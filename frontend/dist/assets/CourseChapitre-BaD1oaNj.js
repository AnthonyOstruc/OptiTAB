import{a as p,e as R,L as H,B as C,D as V,h as I,C as J,A as O,o,d as e,j as k,b as r,t as l,i as g,n as _,F as D,s as b,x as w}from"./vendor-1gmgAmFu.js";import{D as P}from"./DashboardLayout-CioqXtbg.js";import{B as U}from"./BackButton-BEaWQV7a.js";import{P as j}from"./PDFDownloadButton-DAAyQF1B.js";import{_ as z,d as W,u as $}from"./index-DCsGFNRY.js";import{c as v}from"./curriculum-snq3CWRS.js";import{g as x}from"./cours-DBoNXykr.js";import{r as M,a as q,g as G}from"./scientificRenderer-SJJ6pUZd.js";import"./menuItems-C0wivC9l.js";import"./matieres-D5ssBX4k.js";import"./ui-jaH5oyHW.js";import"./pdf-B39ievqC.js";import"./mathlive-B5k0jhbN.js";const K={class:"course-chapitre-section"},Q={class:"course-chapitre-title"},X={class:"display-toggle-container"},Y={class:"toggle-text"},Z={key:0,class:"pdf-buttons-group"},ee={class:"course-header"},te={class:"course-description"},se={class:"course-body"},ae={key:0,class:"loading-state"},oe={key:1,class:"coming-soon"},re={key:2,class:"cours-list"},ne={class:"cours-header"},ie={class:"cours-title"},ce={key:0,class:"cours-description"},le=["innerHTML"],ue={key:1,class:"cours-images"},de=["src","alt"],pe={key:0,class:"image-legende"},he={class:"cours-meta"},ge={class:"cours-date"},_e={key:1,class:"loading-state"},ve=12e4,fe={__name:"CourseChapitre",setup(me){const f=H(),h=O();W(),$();const i=p(null);p([]);const n=p([]),u=p(!0),d=p(!1);async function S(){try{const t=f.params.chapitreId;if(!t){h.back();return}const s=(i.value||await v(t))?.notion;s?h.push({name:"CourseChapitres",params:{notionId:s}}):h.back()}catch{h.back()}}function B(t){return{easy:"Facile",medium:"Moyen",hard:"Difficile"}[t]||t}function L(t){return new Date(t).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})}function N(t){t.target.tagName}function A(){d.value=!d.value}function m(t){return`course_chapitre:${t}`}function F(t){try{const a=localStorage.getItem(m(t));if(!a)return null;const s=JSON.parse(a);return!s?.t||!s?.v||Date.now()-s.t>ve?null:s.v}catch{return null}}function y(t,a){try{localStorage.setItem(m(t),JSON.stringify({t:Date.now(),v:a}))}catch{}}return R(async()=>{u.value=!0;try{const t=f.params.chapitreId;if(!t)return;const a=F(t);if(a){i.value=a.chapitre||null,n.value=Array.isArray(a.cours)?a.cours:[],u.value=!1,v(t).then(async T=>{const{data:E}=await x(null,null,t);y(t,{chapitre:T,cours:E||[]})}).catch(()=>{});return}const s=await v(t);i.value=s;const{data:c}=await x(null,null,t);n.value=c||[],y(t,{chapitre:s,cours:n.value}),C(()=>{M()})}catch{i.value=null,n.value=[]}finally{u.value=!1}}),V(n,()=>{C(()=>{M()})},{deep:!0}),(t,a)=>(o(),I(P,null,{default:J(()=>[e("section",K,[k(U,{text:"Retour aux chapitres",customAction:S,position:"top-left"}),e("h2",Q,l(i.value?.nom||"Cours en ligne"),1),e("div",X,[e("button",{class:_(["display-toggle-btn",{active:d.value}]),onClick:A},[a[0]||(a[0]=e("span",{class:"toggle-icon"},[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 3h18v18H3z"}),e("path",{d:"M3 9h18"}),e("path",{d:"M9 21V9"})])],-1)),e("span",Y,l(d.value?"Normal":"Large"),1)],2),!u.value&&n.value.length>0?(o(),r("div",Z,[k(j,{type:"cours",data:n.value,title:`Cours_${i.value?.nom||"Chapitre"}`,text:"üìÑ PDF",useMathJax:!0,includeSolution:!1,class:"pdf-btn-compact"},null,8,["data","title"])])):g("",!0)]),i.value?(o(),r("div",{key:0,class:_(["course-content",{"wide-display":d.value}])},[e("div",ee,[e("p",te,l(i.value.description),1)]),e("div",se,[u.value?(o(),r("div",ae,a[1]||(a[1]=[e("div",{class:"loading-spinner"},null,-1),e("span",null,"Chargement des cours...",-1)]))):n.value.length===0?(o(),r("div",oe,a[2]||(a[2]=[e("div",{class:"coming-soon-icon"},"üìö",-1),e("h3",null,"Aucun cours disponible",-1),e("p",null,"Il n'y a pas encore de cours pour ce chapitre.",-1),e("p",null,"Les cours seront bient√¥t disponibles.",-1)]))):(o(),r("div",re,[(o(!0),r(D,null,b(n.value,s=>(o(),r("div",{key:s.id,class:"cours-item"},[e("div",ne,[e("h3",ie,l(s.titre),1),e("span",{class:_(["cours-difficulty",s.difficulty])},l(B(s.difficulty)),3)]),s.description?(o(),r("div",ce,l(s.description),1)):g("",!0),e("div",{class:"cours-content",innerHTML:w(q)(s.contenu,s.images),onClick:N},null,8,le),s.images&&s.images.length>0?(o(),r("div",ue,[(o(!0),r(D,null,b(s.images,c=>(o(),r("div",{key:c.id,class:"cours-image"},[e("img",{src:w(G)(c.image),alt:c.legende||c.image_type},null,8,de),c.legende?(o(),r("div",pe,l(c.legende),1)):g("",!0)]))),128))])):g("",!0),e("div",he,[e("span",ge,"Cr√©√© le "+l(L(s.date_creation)),1)])]))),128))]))])],2)):(o(),r("div",_e,a[3]||(a[3]=[e("div",{class:"loading-spinner"},null,-1),e("span",null,"Chargement du cours...",-1)])))])]),_:1}))}},Fe=z(fe,[["__scopeId","data-v-7fcc122a"]]);export{Fe as default};
