import{_ as K,h as M,aH as ae,m as q,s as V,p as Q,c as p,a as e,t as g,l as X,k as j,v as z,z as W,F as I,e as F,j as B,b as L,a2 as ie,B as oe,o as u,d as _,f as Y,u as Z}from"./index-C20tTf3S.js";import{g as re,d as ce,b as ue,u as ve,c as pe}from"./synthesis-CPiG3z-Q.js";import{g as me}from"./curriculum-C6dJwtfd.js";import{g as fe}from"./matieres-Ce1WeeoH.js";var he=typeof global=="object"&&global&&global.Object===Object&&global,ge=typeof self=="object"&&self&&self.Object===Object&&self,ne=he||ge||Function("return this")(),R=ne.Symbol,de=Object.prototype,be=de.hasOwnProperty,ye=de.toString,A=R?R.toStringTag:void 0;function $e(t){var c=be.call(t,A),o=t[A];try{t[A]=void 0;var y=!0}catch{}var b=ye.call(t);return y&&(c?t[A]=o:delete t[A]),b}var xe=Object.prototype,we=xe.toString;function ke(t){return we.call(t)}var Te="[object Null]",_e="[object Undefined]",ee=R?R.toStringTag:void 0;function Ce(t){return t==null?t===void 0?_e:Te:ee&&ee in Object(t)?$e(t):ke(t)}function Me(t){return t!=null&&typeof t=="object"}var Se="[object Symbol]";function Ee(t){return typeof t=="symbol"||Me(t)&&Ce(t)==Se}var Pe=/\s/;function Le(t){for(var c=t.length;c--&&Pe.test(t.charAt(c)););return c}var Oe=/^\s+/;function je(t){return t&&t.slice(0,Le(t)+1).replace(Oe,"")}function G(t){var c=typeof t;return t!=null&&(c=="object"||c=="function")}var te=NaN,De=/^[-+]0x[0-9a-f]+$/i,Ne=/^0b[01]+$/i,qe=/^0o[0-7]+$/i,Ie=parseInt;function se(t){if(typeof t=="number")return t;if(Ee(t))return te;if(G(t)){var c=typeof t.valueOf=="function"?t.valueOf():t;t=G(c)?c+"":c}if(typeof t!="string")return t===0?t:+t;t=je(t);var o=Ne.test(t);return o||qe.test(t)?Ie(t.slice(2),o?2:8):De.test(t)?te:+t}var J=function(){return ne.Date.now()},Fe="Expected a function",Ae=Math.max,ze=Math.min;function Be(t,c,o){var y,b,h,k,n,x,T=0,$=!1,C=!1,w=!0;if(typeof t!="function")throw new TypeError(Fe);c=se(c)||0,G(o)&&($=!!o.leading,C="maxWait"in o,h=C?Ae(se(o.maxWait)||0,c):h,w="trailing"in o?!!o.trailing:w);function E(f){var S=y,N=b;return y=b=void 0,T=f,k=t.apply(N,S),k}function P(f){return T=f,n=setTimeout(i,c),$?E(f):k}function O(f){var S=f-x,N=f-T,H=c-S;return C?ze(H,h-N):H}function v(f){var S=f-x,N=f-T;return x===void 0||S>=c||S<0||C&&N>=h}function i(){var f=J();if(v(f))return s(f);n=setTimeout(i,O(f))}function s(f){return n=void 0,w&&y?E(f):(y=b=void 0,k)}function a(){n!==void 0&&clearTimeout(n),T=0,y=x=b=n=void 0}function r(){return n===void 0?k:s(J())}function D(){var f=J(),S=v(f);if(y=arguments,b=this,x=f,S){if(n===void 0)return P(x);if(C)return clearTimeout(n),n=setTimeout(i,c),E(x)}return n===void 0&&(n=setTimeout(i,c)),k}return D.cancel=a,D.flush=r,D}const He={class:"modal-header"},Re={class:"modal-body"},Ue={class:"form-section"},Je={class:"form-row"},Ve={class:"form-group"},Xe={class:"form-row"},We={class:"form-group"},Ge=["value"],Ke={class:"form-group"},Qe={class:"form-row"},Ye={class:"form-group"},Ze={class:"form-group"},et={class:"form-section"},tt={class:"tabs-container"},st={class:"tabs-header"},at={class:"tab-content"},it={key:0,class:"editor-tab"},ot={class:"form-group"},nt={key:1,class:"preview-tab"},dt=["innerHTML"],lt={class:"modal-footer"},rt=["disabled"],ct={__name:"SheetModal",props:{sheet:Object,isEdit:Boolean,notions:Array},emits:["close","save","preview"],setup(t,{emit:c}){const o=t,y=c,b=M(!1),h=M("editor"),k=M(null),n=ae({titre:"",notion:"",summary:"",difficulty:"medium",ordre:0,reading_time_minutes:5}),x=s=>{if(!s)return"";const a=s.matiere_nom||s.contexte_detail&&s.contexte_detail.matiere_nom||"",r=s.contexte_detail&&s.contexte_detail.pays?s.contexte_detail.pays.nom:"",D=s.contexte_detail&&s.contexte_detail.niveau?s.contexte_detail.niveau.nom:"",f=s.theme_nom||"";return[s.titre||s.nom,f,a,[r,D].filter(Boolean).join(" - ")].filter(Boolean).join(" — ")};q(()=>{if(!n.summary)return`<p class="empty-preview">Écrivez du contenu pour voir l'aperçu...</p>`;try{return T(n.summary)}catch{return'<p class="error-preview">Erreur dans le contenu</p>'}});function T(s){return s?s.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/\\/g,"\\").replace(/^###\s+(.+)$/gm,'<h3 class="markdown-h3">$1</h3>').replace(/^##\s+(.+)$/gm,'<h2 class="markdown-h2">$1</h2>').replace(/^#\s+(.+)$/gm,'<h1 class="markdown-h1">$1</h1>').replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>").replace(/\*([^*]+)\*/g,"<em>$1</em>").replace(/<p[^>]*style="[^"]*color:blue[^"]*"[^>]*>([^<]+)<\/p>/g,'<h2 class="markdown-h2 blue-title">$1</h2>').replace(/<p[^>]*style="[^"]*color:darkorange[^"]*"[^>]*>([^<]+)<\/p>/g,'<h3 class="markdown-h3 orange-title">$1</h3>').replace(/<p[^>]*style="[^"]*color:red[^"]*"[^"]*"[^>]*>([^<]+)<\/p>/g,'<h3 class="markdown-h3 red-title">$1</h3>').replace(/<p[^>]*style="[^"]*color:green[^"]*"[^"]*"[^>]*>([^<]+)<\/p>/g,'<h3 class="markdown-h3 green-title">$1</h3>').replace(/<p[^>]*style="[^"]*color:purple[^"]*"[^"]*"[^>]*>([^<]+)<\/p>/g,'<h3 class="markdown-h3 purple-title">$1</h3>').replace(/\n\n/g,'<br class="double-break"/>').replace(/\n/g,'<br class="single-break"/>').replace(/  /g,"&nbsp;&nbsp;"):""}function $(){oe(()=>{if(window.MathJax&&window.MathJax.typesetPromise)window.MathJax.typesetPromise();else{let a=0;const r=()=>{window.MathJax&&window.MathJax.typesetPromise?window.MathJax.typesetPromise():a++<10&&setTimeout(r,150)};setTimeout(r,100)}})}function C(s){return s?T(s):""}const w=()=>{console.log("🔍 initializeForm appelé avec props.sheet:",o.sheet),o.sheet&&(console.log("🔍 Données de la fiche:",{titre:o.sheet.titre,notion:o.sheet.notion,summary:o.sheet.summary,difficulty:o.sheet.difficulty,ordre:o.sheet.ordre,reading_time_minutes:o.sheet.reading_time_minutes}),Object.assign(n,{titre:o.sheet.titre||"",notion:o.sheet.notion||"",summary:o.sheet.summary||"",difficulty:o.sheet.difficulty||"medium",ordre:o.sheet.ordre||0,reading_time_minutes:o.sheet.reading_time_minutes||5}),console.log("🔍 Form après initialisation:",n))},E=async()=>{if(!b.value){b.value=!0;try{const s={...n,key_points:[],formulas:[],examples:[]};await y("save",s)}catch(s){console.error("Erreur lors de la sauvegarde:",s)}finally{b.value=!1}}},P=()=>{const s={titre:n.titre,summary:n.summary,key_points:[],formulas:[],examples:[],difficulty:n.difficulty,reading_time_minutes:n.reading_time_minutes};y("preview",s)},O=s=>{s.target===s.currentTarget&&y("close")},v=()=>{},i=()=>{h.value==="preview"&&setTimeout($,100)};return V(()=>o.sheet,w,{immediate:!0}),Q(()=>{w()}),V(h,s=>{s==="preview"&&setTimeout($,100)}),(s,a)=>(u(),p("div",{class:"modal-overlay",onClick:O},[e("div",{class:"modal-container",onClick:a[11]||(a[11]=X(()=>{},["stop"]))},[e("div",He,[e("h2",null,g(t.isEdit?"Modifier":"Créer")+" une fiche de synthèse",1),e("button",{class:"close-btn",onClick:a[0]||(a[0]=r=>s.$emit("close"))},"×")]),e("div",Re,[e("form",{onSubmit:X(E,["prevent"]),class:"sheet-form"},[e("div",Ue,[a[19]||(a[19]=e("h3",null,"Informations générales",-1)),e("div",Je,[e("div",Ve,[a[12]||(a[12]=e("label",{for:"titre",class:"required"},"Titre de la fiche",-1)),j(e("input",{id:"titre","onUpdate:modelValue":a[1]||(a[1]=r=>n.titre=r),type:"text",placeholder:"Ex: Les dérivées - Résumé",required:"",class:"form-input"},null,512),[[z,n.titre]])])]),e("div",Xe,[e("div",We,[a[14]||(a[14]=e("label",{for:"notion",class:"required"},"Notion (hérite du contexte via Thème)",-1)),j(e("select",{id:"notion","onUpdate:modelValue":a[2]||(a[2]=r=>n.notion=r),required:"",class:"form-select",onChange:v},[a[13]||(a[13]=e("option",{value:""},"Choisir une notion",-1)),(u(!0),p(I,null,F(o.notions,r=>(u(),p("option",{key:r.id,value:r.id},g(x(r)),9,Ge))),128))],544),[[W,n.notion]])]),e("div",Ke,[a[16]||(a[16]=e("label",{for:"difficulty"},"Difficulté",-1)),j(e("select",{id:"difficulty","onUpdate:modelValue":a[3]||(a[3]=r=>n.difficulty=r),class:"form-select"},a[15]||(a[15]=[e("option",{value:"easy"},"Facile",-1),e("option",{value:"medium"},"Moyen",-1),e("option",{value:"hard"},"Difficile",-1)]),512),[[W,n.difficulty]])])]),e("div",Qe,[e("div",Ye,[a[17]||(a[17]=e("label",{for:"ordre"},"Ordre d'affichage",-1)),j(e("input",{id:"ordre","onUpdate:modelValue":a[4]||(a[4]=r=>n.ordre=r),type:"number",min:"0",class:"form-input"},null,512),[[z,n.ordre,void 0,{number:!0}]])]),e("div",Ze,[a[18]||(a[18]=e("label",{for:"reading_time"},"Temps de lecture (min)",-1)),j(e("input",{id:"reading_time","onUpdate:modelValue":a[5]||(a[5]=r=>n.reading_time_minutes=r),type:"number",min:"1",max:"60",class:"form-input"},null,512),[[z,n.reading_time_minutes,void 0,{number:!0}]])])])]),e("div",et,[a[21]||(a[21]=e("h3",null,"Contenu de la fiche",-1)),e("div",tt,[e("div",st,[e("button",{type:"button",class:B(["tab-btn",{active:h.value==="editor"}]),onClick:a[6]||(a[6]=r=>h.value="editor")}," ✏️ Éditeur ",2),e("button",{type:"button",class:B(["tab-btn",{active:h.value==="preview"}]),onClick:a[7]||(a[7]=r=>h.value="preview")}," 👁️ Aperçu ",2)]),e("div",at,[h.value==="editor"?(u(),p("div",it,[e("div",ot,[a[20]||(a[20]=ie(`<label for="summary" data-v-47480cfd>Contenu principal (Markdown + LaTeX)</label><div class="editor-help" data-v-47480cfd><div class="help-header" data-v-47480cfd><h4 class="help-title" data-v-47480cfd><span class="help-icon" data-v-47480cfd>📝</span> Guide de création de fiches de synthèse </h4><p class="help-subtitle" data-v-47480cfd>Créez des fiches claires et structurées pour optimiser l&#39;apprentissage</p></div><div class="help-content" data-v-47480cfd><div class="help-section" data-v-47480cfd><div class="section-header" data-v-47480cfd><h5 class="section-title" data-v-47480cfd><span class="section-icon" data-v-47480cfd>🎯</span> Structure recommandée </h5></div><div class="structure-example" data-v-47480cfd><div class="code-header" data-v-47480cfd><span class="code-label" data-v-47480cfd>Modèle de fiche</span></div><pre class="code-block" data-v-47480cfd><code data-v-47480cfd># Titre principal de la notion

## Définition
Définition claire et précise du concept

## Propriétés importantes
• Propriété 1 : description
• Propriété 2 : description
→ Propriété 3 : description

## Formules clés
$$f(x) = ax^2 + bx + c$$
$$x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$$

## Exemples d&#39;application
Exemple: Calcul de la dérivée de $f(x) = x^2 + 3x + 1$
Solution: $f&#39;(x) = 2x + 3$

## Points à retenir
⚠️ Attention aux erreurs courantes
💡 Astuce pour mémoriser</code></pre></div></div><div class="help-section" data-v-47480cfd><div class="section-header" data-v-47480cfd><h5 class="section-title" data-v-47480cfd><span class="section-icon" data-v-47480cfd>🔧</span> Outils de formatage </h5></div><div class="formatting-tools" data-v-47480cfd><div class="tool-category" data-v-47480cfd><h6 class="category-title" data-v-47480cfd>Titres</h6><div class="tool-grid" data-v-47480cfd><div class="tool-item" data-v-47480cfd><code class="tool-code" data-v-47480cfd># Titre principal</code><span class="tool-desc" data-v-47480cfd>Titre de niveau 1</span></div><div class="tool-item" data-v-47480cfd><code class="tool-code" data-v-47480cfd>## Sous-titre</code><span class="tool-desc" data-v-47480cfd>Titre de niveau 2</span></div><div class="tool-item" data-v-47480cfd><code class="tool-code" data-v-47480cfd>### Section</code><span class="tool-desc" data-v-47480cfd>Titre de niveau 3</span></div></div></div><div class="tool-category" data-v-47480cfd><h6 class="category-title" data-v-47480cfd>Texte</h6><div class="tool-grid" data-v-47480cfd><div class="tool-item" data-v-47480cfd><code class="tool-code" data-v-47480cfd>**gras**</code><span class="tool-desc" data-v-47480cfd>Texte en gras</span></div><div class="tool-item" data-v-47480cfd><code class="tool-code" data-v-47480cfd>*italique*</code><span class="tool-desc" data-v-47480cfd>Texte en italique</span></div></div></div><div class="tool-category" data-v-47480cfd><h6 class="category-title" data-v-47480cfd>Listes</h6><div class="tool-grid" data-v-47480cfd><div class="tool-item" data-v-47480cfd><code class="tool-code" data-v-47480cfd>• Point important</code><span class="tool-desc" data-v-47480cfd>Liste à puces</span></div><div class="tool-item" data-v-47480cfd><code class="tool-code" data-v-47480cfd>→ Information clé</code><span class="tool-desc" data-v-47480cfd>Liste avec flèche</span></div></div></div><div class="tool-category" data-v-47480cfd><h6 class="category-title" data-v-47480cfd>Mise en forme</h6><div class="tool-grid" data-v-47480cfd><div class="tool-item" data-v-47480cfd><code class="tool-code" data-v-47480cfd>Définition: texte</code><span class="tool-desc" data-v-47480cfd>Définition</span></div><div class="tool-item" data-v-47480cfd><code class="tool-code" data-v-47480cfd>Théorème: énoncé</code><span class="tool-desc" data-v-47480cfd>Théorème</span></div><div class="tool-item" data-v-47480cfd><code class="tool-code" data-v-47480cfd>Propriété: description</code><span class="tool-desc" data-v-47480cfd>Propriété</span></div><div class="tool-item" data-v-47480cfd><code class="tool-code" data-v-47480cfd>Exemple: cas concret</code><span class="tool-desc" data-v-47480cfd>Exemple</span></div></div></div><div class="tool-category" data-v-47480cfd><h6 class="category-title" data-v-47480cfd>Alertes</h6><div class="tool-grid" data-v-47480cfd><div class="tool-item" data-v-47480cfd><code class="tool-code" data-v-47480cfd>⚠️ Attention</code><span class="tool-desc" data-v-47480cfd>Avertissement</span></div><div class="tool-item" data-v-47480cfd><code class="tool-code" data-v-47480cfd>💡 Conseil</code><span class="tool-desc" data-v-47480cfd>Conseil</span></div></div></div></div></div><div class="help-section" data-v-47480cfd><div class="section-header" data-v-47480cfd><h5 class="section-title" data-v-47480cfd><span class="section-icon" data-v-47480cfd>📐</span> Formules mathématiques (LaTeX) </h5></div><div class="math-examples" data-v-47480cfd><div class="math-category" data-v-47480cfd><h6 class="category-title" data-v-47480cfd>Formules inline</h6><div class="math-grid" data-v-47480cfd><div class="math-item" data-v-47480cfd><code class="math-code" data-v-47480cfd>$x^2 + y^2 = r^2$</code><span class="math-desc" data-v-47480cfd>Équation du cercle</span></div><div class="math-item" data-v-47480cfd><code class="math-code" data-v-47480cfd>$\\frac{a}{b}$</code><span class="math-desc" data-v-47480cfd>Fraction</span></div><div class="math-item" data-v-47480cfd><code class="math-code" data-v-47480cfd>$\\sqrt{x}$</code><span class="math-desc" data-v-47480cfd>Racine carrée</span></div></div></div><div class="math-category" data-v-47480cfd><h6 class="category-title" data-v-47480cfd>Formules en bloc</h6><div class="math-grid" data-v-47480cfd><div class="math-item" data-v-47480cfd><code class="math-code" data-v-47480cfd>$$\\int_{a}^{b} f(x) dx$$</code><span class="math-desc" data-v-47480cfd>Intégrale</span></div><div class="math-item" data-v-47480cfd><code class="math-code" data-v-47480cfd>$$\\lim_{x \\to 0} \\frac{\\sin(x)}{x} = 1$$</code><span class="math-desc" data-v-47480cfd>Limite</span></div></div></div><div class="math-category" data-v-47480cfd><h6 class="category-title" data-v-47480cfd>Symboles courants</h6><div class="math-grid" data-v-47480cfd><div class="math-item" data-v-47480cfd><code class="math-code" data-v-47480cfd>$\\alpha, \\beta, \\gamma$</code><span class="math-desc" data-v-47480cfd>Lettres grecques</span></div><div class="math-item" data-v-47480cfd><code class="math-code" data-v-47480cfd>$\\sum_{i=1}^{n} x_i$</code><span class="math-desc" data-v-47480cfd>Somme</span></div><div class="math-item" data-v-47480cfd><code class="math-code" data-v-47480cfd>$\\prod_{i=1}^{n} x_i$</code><span class="math-desc" data-v-47480cfd>Produit</span></div></div></div></div></div><div class="help-section" data-v-47480cfd><div class="section-header" data-v-47480cfd><h5 class="section-title" data-v-47480cfd><span class="section-icon" data-v-47480cfd>💡</span> Conseils pour une bonne synthèse </h5></div><div class="tips-container" data-v-47480cfd><div class="tips-grid" data-v-47480cfd><div class="tip-item" data-v-47480cfd><div class="tip-icon" data-v-47480cfd>🎯</div><div class="tip-content" data-v-47480cfd><h6 class="tip-title" data-v-47480cfd>Clarté</h6><p class="tip-desc" data-v-47480cfd>Utilisez des phrases courtes et directes</p></div></div><div class="tip-item" data-v-47480cfd><div class="tip-icon" data-v-47480cfd>📋</div><div class="tip-content" data-v-47480cfd><h6 class="tip-title" data-v-47480cfd>Structure</h6><p class="tip-desc" data-v-47480cfd>Organisez l&#39;information de manière logique</p></div></div><div class="tip-item" data-v-47480cfd><div class="tip-icon" data-v-47480cfd>🔍</div><div class="tip-content" data-v-47480cfd><h6 class="tip-title" data-v-47480cfd>Exemples</h6><p class="tip-desc" data-v-47480cfd>Donnez toujours des exemples concrets</p></div></div><div class="tip-item" data-v-47480cfd><div class="tip-icon" data-v-47480cfd>📐</div><div class="tip-content" data-v-47480cfd><h6 class="tip-title" data-v-47480cfd>Formules</h6><p class="tip-desc" data-v-47480cfd>Expliquez le sens des formules, pas juste leur écriture</p></div></div><div class="tip-item" data-v-47480cfd><div class="tip-icon" data-v-47480cfd>🔗</div><div class="tip-content" data-v-47480cfd><h6 class="tip-title" data-v-47480cfd>Connexions</h6><p class="tip-desc" data-v-47480cfd>Montrez les liens avec d&#39;autres notions</p></div></div><div class="tip-item" data-v-47480cfd><div class="tip-icon" data-v-47480cfd>⚡</div><div class="tip-content" data-v-47480cfd><h6 class="tip-title" data-v-47480cfd>Méthodes</h6><p class="tip-desc" data-v-47480cfd>Incluez des étapes de résolution</p></div></div></div></div></div></div></div>`,2)),j(e("textarea",{id:"summary",ref_key:"summaryTextarea",ref:k,"onUpdate:modelValue":a[8]||(a[8]=r=>n.summary=r),rows:"15",placeholder:"Rédigez le contenu de votre fiche en Markdown...",class:"form-textarea markdown-editor",onInput:i},null,544),[[z,n.summary]])])])):L("",!0),h.value==="preview"?(u(),p("div",nt,[e("div",{class:"preview-container",innerHTML:C(s.renderedMarkdown),onVnodeMounted:a[9]||(a[9]=(...r)=>s.renderMathJax&&s.renderMathJax(...r))},null,8,dt)])):L("",!0)])])])],32)]),e("div",lt,[e("button",{type:"button",class:"btn btn-outline",onClick:a[10]||(a[10]=r=>s.$emit("close"))}," Annuler "),e("button",{type:"button",class:"btn btn-secondary",onClick:P}," 👁️ Aperçu complet "),e("button",{type:"button",class:"btn btn-primary",onClick:E,disabled:!n.titre||!n.notion||b.value},g(b.value?"Sauvegarde...":t.isEdit?"Mettre à jour":"Créer"),9,rt)])])]))}},ut=K(ct,[["__scopeId","data-v-47480cfd"]]),vt={class:"preview-header"},pt={class:"header-content"},mt={class:"preview-meta"},ft={class:"reading-time"},ht={class:"preview-body"},gt={class:"sheet-preview"},bt={class:"sheet-header"},yt={class:"sheet-title"},$t={key:0,class:"sheet-context"},xt={class:"context-badges"},wt={class:"context-badge notion"},kt={key:0,class:"context-badge theme"},Tt={key:1,class:"context-badge matiere"},_t={class:"sheet-content"},Ct={key:0,class:"main-content"},Mt=["innerHTML"],St={key:1,class:"empty-content"},Et={key:0,class:"sheet-section key-points"},Pt={class:"key-points-list"},Lt=["innerHTML"],Ot={key:1,class:"sheet-section formulas"},jt={class:"formulas-list"},Dt=["innerHTML"],Nt={key:2,class:"sheet-section examples"},qt={class:"examples-list"},It=["innerHTML"],Ft={class:"preview-footer"},At={class:"content-stats"},zt={class:"stat-chip"},Bt={class:"stat-chip"},Ht={class:"stat-chip"},Rt={__name:"PreviewModal",props:{sheet:Object},emits:["close"],setup(t,{emit:c}){const o=t,y=c,b=q(()=>{if(!o.sheet?.summary)return"";try{return E(o.sheet.summary)}catch{return'<p class="error">Erreur dans le rendu du contenu</p>'}}),h=q(()=>o.sheet?.key_points&&o.sheet.key_points.length>0),k=q(()=>o.sheet?.formulas&&o.sheet.formulas.length>0),n=q(()=>o.sheet?.examples&&o.sheet.examples.length>0),x=q(()=>o.sheet?.summary?o.sheet.summary.split(/\s+/).filter(v=>v.length>0).length:0),T=q(()=>{const i=Math.ceil(x.value/200);return Math.max(1,i)}),$=v=>({easy:"Facile",medium:"Moyen",hard:"Difficile"})[v]||v,C=v=>{v.target===v.currentTarget&&y("close")};function w(v){if(!v)return 0;const i=[/\$[^$]+\$/g,/\$\$[^$]+\$\$/g];let s=0;return i.forEach(a=>{const r=v.match(a);r&&(s+=r.length)}),s}function E(v){return v?v.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/\\/g,"\\").trim():""}function P(v){return v?v.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/<p[^>]*style="[^"]*color:blue[^"]*"[^>]*>([^<]+)<\/p>/g,'<h2 class="section-title blue">$1</h2>').replace(/<p[^>]*style="[^"]*color:darkorange[^"]*"[^>]*>([^<]+)<\/p>/g,'<h3 class="subsection-title orange">$1</h3>').replace(/<p[^>]*style="[^"]*color:red[^"]*"[^>]*>([^<]+)<\/p>/g,'<div class="alert-box warning">$1</div>').replace(/<p[^>]*style="[^"]*color:green[^"]*"[^>]*>([^<]+)<\/p>/g,'<div class="alert-box success">$1</div>').replace(/<p[^>]*style="[^"]*color:purple[^"]*"[^>]*>([^<]+)<\/p>/g,'<h4 class="example-title">$1</h4>').replace(/^###\s+(.+)$/gm,'<h3 class="subsection-title">$1</h3>').replace(/^##\s+(.+)$/gm,'<h2 class="section-title">$1</h2>').replace(/^#\s+(.+)$/gm,'<h1 class="main-title">$1</h1>').replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>").replace(/\*([^*]+)\*/g,"<em>$1</em>").replace(/\n\n/g,"<br/>").replace(/\n/g,"<br/>").trim():""}function O(){oe(()=>{if(window.MathJax&&window.MathJax.typesetPromise)window.MathJax.typesetPromise();else{let i=0;const s=()=>{window.MathJax&&window.MathJax.typesetPromise?window.MathJax.typesetPromise():i++<10&&setTimeout(s,150)};setTimeout(s,100)}})}return V(()=>o.sheet,()=>{o.sheet&&setTimeout(O,100)},{deep:!0}),Q(()=>{o.sheet&&setTimeout(O,100)}),(v,i)=>(u(),p("div",{class:"preview-overlay",onClick:C},[e("div",{class:"preview-container",onClick:i[2]||(i[2]=X(()=>{},["stop"]))},[e("div",vt,[e("div",pt,[i[4]||(i[4]=e("h2",{class:"preview-title"},[e("span",{class:"title-icon"},"👁️"),_(" Aperçu de la fiche ")],-1)),e("div",mt,[e("span",{class:B(["difficulty-badge",t.sheet?.difficulty])},g($(t.sheet?.difficulty)),3),e("span",ft,[i[3]||(i[3]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("polyline",{points:"12,6 12,12 16,14"})],-1)),_(" "+g(t.sheet?.reading_time_minutes||5)+" min ",1)])])]),e("button",{class:"close-button",onClick:i[0]||(i[0]=s=>v.$emit("close"))},i[5]||(i[5]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]))]),e("div",ht,[e("div",gt,[e("div",bt,[e("h1",yt,g(t.sheet?.titre||"Titre de la fiche"),1),t.sheet?.notion_info?(u(),p("div",$t,[e("div",xt,[e("span",wt,[i[6]||(i[6]=e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e("polyline",{points:"14,2 14,8 20,8"})],-1)),_(" "+g(t.sheet.notion_info.titre),1)]),t.sheet.notion_info.theme?(u(),p("span",kt,[i[7]||(i[7]=e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"3"}),e("path",{d:"M12 1v6m0 6v6m11-7h-6m-6 0H1"})],-1)),_(" "+g(t.sheet.notion_info.theme.titre),1)])):L("",!0),t.sheet.notion_info.theme?.matiere?(u(),p("span",Tt,[i[8]||(i[8]=e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})],-1)),_(" "+g(t.sheet.notion_info.theme.matiere.titre),1)])):L("",!0)])])):L("",!0)]),e("div",_t,[t.sheet?.summary?(u(),p("div",Ct,[e("div",{class:"content-html",innerHTML:P(b.value)},null,8,Mt)])):(u(),p("div",St,i[9]||(i[9]=[e("div",{class:"empty-icon"},"📄",-1),e("h3",null,"Aucun contenu à prévisualiser",-1),e("p",null,"Ajoutez du contenu pour voir l'aperçu",-1)])))]),h.value?(u(),p("div",Et,[i[10]||(i[10]=e("h3",{class:"section-title"},[e("span",{class:"section-icon"},"🎯"),_(" Points clés à retenir ")],-1)),e("ul",Pt,[(u(!0),p(I,null,F(t.sheet.key_points,s=>(u(),p("li",{key:s,innerHTML:P(s)},null,8,Lt))),128))])])):L("",!0),k.value?(u(),p("div",Ot,[i[11]||(i[11]=e("h3",{class:"section-title"},[e("span",{class:"section-icon"},"📐"),_(" Formules importantes ")],-1)),e("div",jt,[(u(!0),p(I,null,F(t.sheet.formulas,s=>(u(),p("div",{key:s,class:"formula-item"},[e("div",{class:"formula-content",innerHTML:P(s)},null,8,Dt)]))),128))])])):L("",!0),n.value?(u(),p("div",Nt,[i[12]||(i[12]=e("h3",{class:"section-title"},[e("span",{class:"section-icon"},"💡"),_(" Exemples et applications ")],-1)),e("div",qt,[(u(!0),p(I,null,F(t.sheet.examples,s=>(u(),p("div",{key:s,class:"example-item"},[e("div",{class:"example-content",innerHTML:P(s)},null,8,It)]))),128))])])):L("",!0)])]),e("div",Ft,[e("div",At,[e("span",zt,[i[13]||(i[13]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e("polyline",{points:"14,2 14,8 20,8"})],-1)),_(" "+g(x.value)+" mots ",1)]),e("span",Bt,[i[14]||(i[14]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"3"}),e("path",{d:"M12 1v6m0 6v6m11-7h-6m-6 0H1"})],-1)),_(" "+g(w(t.sheet?.summary))+" formules ",1)]),e("span",Ht,[i[15]||(i[15]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("polyline",{points:"12,6 12,12 16,14"})],-1)),_(" "+g(T.value)+" min ",1)])]),e("button",{class:"close-action-btn",onClick:i[1]||(i[1]=s=>v.$emit("close"))},i[16]||(i[16]=[e("span",null,"Fermer",-1),e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]))])])]))}},Ut=K(Rt,[["__scopeId","data-v-befaa155"]]),Jt={class:"admin-sheets"},Vt={class:"page-header"},Xt={class:"header-actions"},Wt=["disabled"],Gt={class:"filters-section"},Kt={class:"filters-row"},Qt={class:"filter-group"},Yt=["value"],Zt={class:"filter-group"},es={class:"sheets-table-container"},ts={key:0,class:"loading-state"},ss={key:1,class:"empty-state"},as={key:2,class:"sheets-table"},is={class:"title-col"},os={class:"matiere-badge"},ns={class:"actions-col"},ds={class:"action-buttons"},ls=["onClick"],rs=["onClick"],cs=["onClick"],us=["onClick"],vs={__name:"AdminSheets",setup(t){const c=M(!1),o=M([]),y=M([]),b=M([]),h=M(!1),k=M(!1),n=M(null),x=M(!1),T=M(null),$=ae({matiere:"",search:""}),C=Be(()=>{w()},300),w=async()=>{c.value=!0;try{const l={};$.matiere&&(l.matiere=$.matiere),$.search&&(l.search=$.search);const d=await re(l);o.value=d.data.results||d.data}catch(l){console.error("Erreur lors du chargement des fiches:",l)}finally{c.value=!1}},E=async()=>{try{const l=await fe();y.value=l||[]}catch(l){console.error("Erreur lors du chargement des matières:",l),y.value=[]}},P=async()=>{try{const l=await me();b.value=l||[]}catch(l){console.error("Erreur lors du chargement des notions:",l),b.value=[]}},O=()=>{n.value=null,x.value=!1,h.value=!0},v=l=>{console.log("🔍 Données de la fiche à éditer:",l),n.value={...l},console.log("🔍 currentSheet après copie:",n.value),x.value=!0,h.value=!0},i=()=>{h.value=!1,n.value=null},s=async l=>{try{x.value?await ve(n.value.id,l):await pe(l),i(),w()}catch(d){throw console.error("Erreur lors de la sauvegarde:",d),d}},a=async l=>{if(confirm(`Êtes-vous sûr de vouloir supprimer la fiche "${l.titre}" ?`))try{await ue(l.id),w()}catch(d){console.error("Erreur lors de la suppression:",d)}},r=async l=>{try{await ce(l.id),w()}catch(d){console.error("Erreur lors de la duplication:",d)}},D=l=>{T.value=l,k.value=!0},f=()=>{k.value=!1,T.value=null},S=l=>{T.value=l,k.value=!0},N=()=>{$.matiere="",$.search="",w()},H=l=>({easy:"Facile",medium:"Moyen",hard:"Difficile"})[l]||l,le=l=>new Date(l).toLocaleDateString("fr-FR");return Q(async()=>{await Promise.all([w(),E(),P()])}),(l,d)=>(u(),p("div",Jt,[d[13]||(d[13]=ie(`<div class="format-help" data-v-0447207b><h3 data-v-0447207b>📋 Guide de création des fiches de synthèse</h3><div class="format-example" data-v-0447207b><pre data-v-0447207b><code data-v-0447207b>Titre: [Titre de la fiche]
Notion: [ID de la notion]
Difficulté: [easy/medium/hard] (optionnel, défaut: medium)
Temps de lecture: [nombre] (en minutes, optionnel, défaut: 5)
Statut: [actif/inactif] (optionnel, défaut: actif)
Points clés: [point1,point2,point3] (optionnel, séparés par des virgules)

=== CONTENU ===

[Contenu principal de la fiche avec HTML/LaTeX supporté]

=== EXEMPLES ===

[Exemples pratiques et exercices d&#39;application]

=== CONSEILS ===

[Conseils méthodologiques et astuces]</code></pre></div><div class="format-notes" data-v-0447207b><p data-v-0447207b><strong data-v-0447207b>Notes importantes :</strong></p><ul data-v-0447207b><li data-v-0447207b><strong data-v-0447207b>⚠️ Champs obligatoires :</strong> <code data-v-0447207b>Titre</code> et contenu principal</li><li data-v-0447207b><strong data-v-0447207b>Notion :</strong> Utilisez l&#39;ID de la notion (trouvable dans la liste des notions)</li><li data-v-0447207b><strong data-v-0447207b>Difficulté :</strong> <code data-v-0447207b>easy</code>, <code data-v-0447207b>medium</code> ou <code data-v-0447207b>hard</code> uniquement</li><li data-v-0447207b><strong data-v-0447207b>Temps de lecture :</strong> Estimation en minutes (aide les étudiants à planifier)</li><li data-v-0447207b><strong data-v-0447207b>Points clés :</strong> Résumé des concepts essentiels, séparés par des virgules</li><li data-v-0447207b><strong data-v-0447207b>Sections :</strong> <code data-v-0447207b>=== CONTENU ===</code>, <code data-v-0447207b>=== EXEMPLES ===</code>, <code data-v-0447207b>=== CONSEILS ===</code></li><li data-v-0447207b><strong data-v-0447207b>Contenu :</strong> Supporte HTML et LaTeX (MathJax)</li><li data-v-0447207b><strong data-v-0447207b>MathJax :</strong> <code data-v-0447207b>$formule$</code> (inline) et <code data-v-0447207b>$$formule$$</code> (bloc)</li><li data-v-0447207b><strong data-v-0447207b>HTML :</strong> <code data-v-0447207b>&lt;strong&gt;</code>, <code data-v-0447207b>&lt;em&gt;</code>, <code data-v-0447207b>&lt;ul&gt;</code>, <code data-v-0447207b>&lt;ol&gt;</code>, etc.</li><li data-v-0447207b><strong data-v-0447207b>Listes :</strong> Utilisez des puces • ou des numéros pour structurer</li><li data-v-0447207b><strong data-v-0447207b>Mise en forme :</strong> Utilisez des titres <code data-v-0447207b>&lt;h3&gt;</code>, <code data-v-0447207b>&lt;h4&gt;</code> pour organiser</li></ul></div><div class="working-example" data-v-0447207b><h4 data-v-0447207b>🎯 Exemple concret :</h4><div class="example-code" data-v-0447207b><pre data-v-0447207b><code data-v-0447207b>Titre: Théorème de Pythagore
Notion: 15
Difficulté: easy
Temps de lecture: 8
Points clés: triangle rectangle,hypoténuse,cathètes,relation métrique

=== CONTENU ===

Le &lt;strong&gt;théorème de Pythagore&lt;/strong&gt; est une relation fondamentale dans les triangles rectangles.

&lt;h3&gt;Énoncé&lt;/h3&gt;
Dans un triangle rectangle, le carré de l&#39;hypoténuse est égal à la somme des carrés des cathètes :

$$a^2 + b^2 = c^2$$

où :
• $a$ et $b$ sont les cathètes
• $c$ est l&#39;hypoténuse

=== EXEMPLES ===

&lt;h4&gt;Exemple 1 : Calcul de l&#39;hypoténuse&lt;/h4&gt;
Triangle avec cathètes de 3 cm et 4 cm :
$$c = \\sqrt{3^2 + 4^2} = \\sqrt{9 + 16} = \\sqrt{25} = 5 \\text{ cm}$$

&lt;h4&gt;Exemple 2 : Calcul d&#39;une cathète&lt;/h4&gt;
Triangle avec hypoténuse de 10 cm et une cathète de 6 cm :
$$b = \\sqrt{10^2 - 6^2} = \\sqrt{100 - 36} = \\sqrt{64} = 8 \\text{ cm}$$

=== CONSEILS ===

• &lt;strong&gt;Vérification :&lt;/strong&gt; Toujours vérifier que $a^2 + b^2 = c^2$
• &lt;strong&gt;Unités :&lt;/strong&gt; Attention aux unités dans les calculs
• &lt;strong&gt;Application :&lt;/strong&gt; Utile en géométrie, trigonométrie et physique</code></pre></div><p class="example-note" data-v-0447207b><strong data-v-0447207b>Résultat :</strong> Cette fiche sera automatiquement formatée avec les sections appropriées, les formules mathématiques rendues et les points clés extraits. </p></div></div>`,1)),e("div",Vt,[d[4]||(d[4]=e("div",{class:"header-left"},[e("h1",{class:"page-title"},[e("span",{class:"icon"},"📋"),_(" Fiches de synthèse ")]),e("p",{class:"page-description"},"Créez et gérez les fiches de révision pour vos étudiants")],-1)),e("div",Xt,[e("button",{class:"btn btn-primary",onClick:O,disabled:c.value},d[3]||(d[3]=[e("span",{class:"icon"},"➕",-1),_(" Nouvelle fiche ")]),8,Wt)])]),e("div",Gt,[e("div",Kt,[e("div",Qt,[d[6]||(d[6]=e("label",null,"Matière :",-1)),j(e("select",{"onUpdate:modelValue":d[0]||(d[0]=m=>$.matiere=m),onChange:w},[d[5]||(d[5]=e("option",{value:""},"Toutes les matières",-1)),(u(!0),p(I,null,F(y.value,m=>(u(),p("option",{key:m.id,value:m.id},g(m.nom),9,Yt))),128))],544),[[W,$.matiere]])]),e("div",Zt,[d[7]||(d[7]=e("label",null,"Recherche :",-1)),j(e("input",{"onUpdate:modelValue":d[1]||(d[1]=m=>$.search=m),onInput:d[2]||(d[2]=(...m)=>Z(C)&&Z(C)(...m)),placeholder:"Titre, contenu...",class:"search-input"},null,544),[[z,$.search]])]),e("div",{class:"filter-group"},[e("button",{class:"btn btn-outline",onClick:N}," Réinitialiser ")])])]),e("div",es,[c.value?(u(),p("div",ts,d[8]||(d[8]=[e("div",{class:"spinner"},null,-1),e("p",null,"Chargement des fiches...",-1)]))):o.value.length===0?(u(),p("div",ss,[d[9]||(d[9]=e("div",{class:"empty-icon"},"📝",-1)),d[10]||(d[10]=e("h3",null,"Aucune fiche de synthèse",-1)),d[11]||(d[11]=e("p",null,"Commencez par créer votre première fiche de révision",-1)),e("button",{class:"btn btn-primary",onClick:O}," Créer une fiche ")])):(u(),p("table",as,[d[12]||(d[12]=e("thead",null,[e("tr",null,[e("th",null,"Titre"),e("th",null,"Notion"),e("th",null,"Matière"),e("th",null,"Difficulté"),e("th",null,"Temps de lecture"),e("th",null,"Statut"),e("th",null,"Créé le"),e("th",{class:"actions-col"},"Actions")])],-1)),e("tbody",null,[(u(!0),p(I,null,F(o.value,m=>(u(),p("tr",{key:m.id,class:"sheet-row"},[e("td",is,[e("strong",null,g(m.titre),1)]),e("td",null,g(m.notion_nom),1),e("td",null,[e("span",os,g(m.matiere_nom),1)]),e("td",null,[e("span",{class:B(["difficulty-badge",m.difficulty])},g(H(m.difficulty)),3)]),e("td",null,g(m.reading_time_minutes)+" min",1),e("td",null,[e("span",{class:B(["status-badge",{active:m.est_actif}])},g(m.est_actif?"Actif":"Inactif"),3)]),e("td",null,g(le(m.date_creation)),1),e("td",ns,[e("div",ds,[e("button",{class:"btn-icon btn-preview",onClick:U=>D(m),title:"Prévisualiser"}," 👁️ ",8,ls),e("button",{class:"btn-icon btn-edit",onClick:U=>v(m),title:"Modifier"}," ✏️ ",8,rs),e("button",{class:"btn-icon btn-duplicate",onClick:U=>r(m),title:"Dupliquer"}," 📋 ",8,cs),e("button",{class:"btn-icon btn-delete",onClick:U=>a(m),title:"Supprimer"}," 🗑️ ",8,us)])])]))),128))])]))]),h.value?(u(),Y(ut,{key:0,sheet:n.value,"is-edit":x.value,notions:b.value,onClose:i,onSave:s,onPreview:S},null,8,["sheet","is-edit","notions"])):L("",!0),k.value?(u(),Y(Ut,{key:1,sheet:T.value,onClose:f},null,8,["sheet"])):L("",!0)]))}},gs=K(vs,[["__scopeId","data-v-0447207b"]]);export{gs as default};
