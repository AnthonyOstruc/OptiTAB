import{D as M}from"./DashboardLayout-DmmXvv68.js";import{c as l,o as n,a as e,_ as b,b as m,t as c,j as h,q as E,h as p,m as D,p as L,k as N,V as j,F as k,e as C,i as x,d as A,u as F,f as w,l as I,A as y,w as U}from"./index-C20tTf3S.js";import"./menuItems-zei-A9he.js";import"./matieres-Ce1WeeoH.js";function T(g,u){return n(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z","clip-rule":"evenodd"})])}const q={name:"LoadingSpinner",props:{small:{type:Boolean,default:!1},text:{type:String,default:""}}},Y={key:0,class:"loading-text"};function Z(g,u,o,_,i,d){return n(),l("div",{class:h(["loading-spinner",{"loading-spinner--small":o.small}])},[u[0]||(u[0]=e("div",{class:"spinner"},null,-1)),o.text?(n(),l("span",Y,c(o.text),1)):m("",!0)],2)}const G=b(q,[["render",Z],["__scopeId","data-v-67bd69f9"]]),H={class:"pricing-container"},J={class:"billing-toggle"},K={class:"toggle-label"},O={class:"plans-grid"},Q={key:0,class:"popular-badge"},R={class:"plan-header"},W={class:"plan-name"},X={class:"plan-price"},ee={class:"price-amount"},se={class:"price-period"},te={key:0,class:"savings"},ae={class:"features-list"},ne=["onClick","disabled"],le={key:1},oe={key:2},ie={class:"modal-actions"},re={__name:"PricingPlans",setup(g){const u=E(),o=p([]),_=p(!1),i=p(null),d=p(!1),v=p(null),r=p(null),P=D(()=>o.value.filter(t=>t.billing_period===(_.value?"yearly":"monthly"))),S=async()=>{try{const t=await y.get("/subscriptions/plans/");o.value=t.data.plans}catch(t){console.error("Erreur lors du chargement des plans:",t)}},V=async()=>{try{const t=await y.get("/subscriptions/status/");t.data.has_subscription&&(r.value=t.data)}catch(t){console.error("Erreur lors du chargement de l'abonnement:",t)}},$=t=>{const a=o.value.find(s=>s.plan_type===t.plan_type&&s.billing_period==="monthly");return a?Math.round(a.price*12-t.price):0},z=t=>{v.value=t,d.value=!0},B=async()=>{if(v.value){i.value=v.value.id,d.value=!1;try{const t=await y.post("/subscriptions/create-checkout-session/",{price_id:v.value.stripe_price_id});window.location.href=t.data.checkout_url}catch(t){console.error("Erreur lors de la création de la session:",t),alert("Erreur lors du processus de paiement. Veuillez réessayer.")}finally{i.value=null}}};return L(()=>{S(),u.isAuthenticated&&V()}),(t,a)=>(n(),l("div",H,[a[7]||(a[7]=e("div",{class:"pricing-header"},[e("h2",{class:"pricing-title"},"Choisissez votre plan"),e("p",{class:"pricing-subtitle"},"Commencez avec 7 jours d'essai gratuit")],-1)),e("div",J,[e("label",K,[N(e("input",{type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=s=>_.value=s),class:"toggle-input"},null,512),[[j,_.value]]),a[4]||(a[4]=e("span",{class:"toggle-slider"},null,-1)),a[5]||(a[5]=e("span",{class:"toggle-text"}," Facturation annuelle (2 mois gratuits) ",-1))])]),e("div",O,[(n(!0),l(k,null,C(P.value,s=>(n(),l("div",{key:s.id,class:h(["plan-card",{popular:s.plan_type==="premium",loading:i.value===s.id}])},[s.plan_type==="premium"?(n(),l("div",Q," Populaire ")):m("",!0),e("div",R,[e("h3",W,c(s.name),1),e("div",X,[e("span",ee,c(s.price)+"€",1),e("span",se,"/"+c(s.billing_period==="monthly"?"mois":"an"),1)]),_.value&&s.billing_period==="yearly"?(n(),l("div",te," Économisez "+c($(s))+"€/an ",1)):m("",!0)]),e("ul",ae,[(n(!0),l(k,null,C(s.features,f=>(n(),l("li",{key:f,class:"feature-item"},[x(F(T),{class:"feature-icon"}),A(" "+c(f),1)]))),128))]),e("button",{onClick:f=>z(s),disabled:i.value===s.id||r.value&&r.value.plan_type===s.plan_type,class:h(["select-plan-btn",{current:r.value&&r.value.plan_type===s.plan_type,loading:i.value===s.id}])},[i.value===s.id?(n(),w(G,{key:0,class:"btn-spinner"})):r.value&&r.value.plan_type===s.plan_type?(n(),l("span",le," Plan actuel ")):(n(),l("span",oe," Commencer l'essai gratuit "))],10,ne)],2))),128))]),d.value?(n(),l("div",{key:0,class:"modal-overlay",onClick:a[3]||(a[3]=s=>d.value=!1)},[e("div",{class:"modal-content",onClick:a[2]||(a[2]=I(()=>{},["stop"]))},[a[6]||(a[6]=e("h3",null,"Confirmer votre choix",-1)),e("p",null,"Vous allez commencer un essai gratuit de 7 jours pour le plan "+c(v.value?.name)+".",1),e("div",ie,[e("button",{onClick:a[1]||(a[1]=s=>d.value=!1),class:"btn-cancel"}," Annuler "),e("button",{onClick:B,class:"btn-confirm"}," Continuer ")])])])):m("",!0)]))}},ce=b(re,[["__scopeId","data-v-3616f13e"]]),ue={class:"pricing-page"},de={__name:"Pricing",setup(g){return(u,o)=>(n(),w(M,null,{default:U(()=>[e("div",ue,[x(ce)])]),_:1}))}},ge=b(de,[["__scopeId","data-v-1e96529f"]]);export{ge as default};
