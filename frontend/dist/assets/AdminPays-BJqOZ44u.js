import{a as v,c as G,D as I,e as D,b as m,i as y,d as e,l as b,t as r,w as A,m as C,K as k,n as f,p as R,o as c,h as V,F as Z,s as H,g as O,j as K}from"./vendor-1gmgAmFu.js";import{_ as S,m as J,E as Q,G as x,H as W}from"./index-DdsjLnq7.js";import"./ui-jaH5oyHW.js";import"./pdf-B39ievqC.js";import"./mathlive-B5k0jhbN.js";const X={name:"PaysModal",props:{visible:{type:Boolean,default:!1},pays:{type:Object,default:null},mode:{type:String,default:"create",validator:n=>["create","edit"].includes(n)}},emits:["save","cancel"],setup(n,{emit:o}){const a=v({nom:"",code_iso:"",drapeau_emoji:"",description:"",ordre:0,est_actif:!0}),s=v({}),p=()=>{n.mode==="edit"&&n.pays?a.value={nom:n.pays.nom||"",code_iso:n.pays.code_iso||"",drapeau_emoji:n.pays.drapeau_emoji||"",description:n.pays.description||"",ordre:n.pays.ordre||0,est_actif:n.pays.est_actif!==void 0?n.pays.est_actif:!0}:a.value={nom:"",code_iso:"",drapeau_emoji:"",description:"",ordre:0,est_actif:!0},s.value={}},g=()=>{const d={};return a.value.nom.trim()?a.value.nom.length<2&&(d.nom="Le nom doit contenir au moins 2 caractères"):d.nom="Le nom du pays est requis",a.value.code_iso.trim()?/^[A-Z]{2,3}$/.test(a.value.code_iso)||(d.code_iso="Le code ISO doit contenir 2-3 lettres majuscules"):d.code_iso="Le code ISO est requis",s.value=d,Object.keys(d).length===0},l=G(()=>a.value.nom.trim()&&a.value.code_iso.trim()&&/^[A-Z]{2,3}$/.test(a.value.code_iso)),h=()=>{if(!g())return;const d={nom:a.value.nom.trim(),code_iso:a.value.code_iso.trim().toUpperCase(),drapeau_emoji:a.value.drapeau_emoji.trim(),description:a.value.description.trim(),ordre:a.value.ordre||0,est_actif:a.value.est_actif};o("save",d)},t=()=>{o("cancel")};return I(()=>a.value.code_iso,d=>{a.value.code_iso=d.toUpperCase()}),I([()=>n.visible,()=>n.pays,()=>n.mode],()=>{n.visible&&p()}),D(()=>{n.visible&&p()}),{form:a,errors:s,isFormValid:l,handleSubmit:h,handleOverlayClick:t,validateForm:g}}},Y={class:"modal-header"},$={class:"form-section"},ee={class:"form-group"},oe={key:0,class:"error-message"},se={class:"form-row"},te={class:"form-group"},ae={key:0,class:"error-message"},ie={class:"form-group"},le={class:"form-group"},ne={class:"form-section"},re={class:"form-row"},de={class:"form-group"},ce={class:"form-group"},me={class:"checkbox-group"},ue={class:"checkbox-label"},fe={key:0,class:"form-section preview-section"},ve={class:"pays-preview"},ye={class:"preview-flag"},_e={class:"preview-info"},be={key:0},pe={key:1},ge={key:0,class:"preview-status inactive"},Ce={key:1,class:"preview-status active"},he={class:"modal-footer"},ke=["disabled"];function we(n,o,a,s,p,g){return a.visible?(c(),m("div",{key:0,class:"modal-overlay",onClick:o[11]||(o[11]=(...l)=>s.handleOverlayClick&&s.handleOverlayClick(...l))},[e("div",{class:"modal-container",onClick:o[10]||(o[10]=A(()=>{},["stop"]))},[e("div",Y,[e("h2",null,[o[12]||(o[12]=e("i",{class:"fas fa-globe"},null,-1)),b(" "+r(a.mode==="create"?"Nouveau Pays":"Modifier le Pays"),1)]),e("button",{onClick:o[0]||(o[0]=l=>n.$emit("cancel")),class:"modal-close"},o[13]||(o[13]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("form",{onSubmit:o[7]||(o[7]=A((...l)=>s.handleSubmit&&s.handleSubmit(...l),["prevent"])),class:"modal-body"},[e("div",$,[o[19]||(o[19]=e("h3",null,[e("i",{class:"fas fa-info-circle"}),b(" Informations générales")],-1)),e("div",ee,[o[14]||(o[14]=e("label",{for:"nom",class:"required"},"Nom du pays",-1)),C(e("input",{id:"nom","onUpdate:modelValue":o[1]||(o[1]=l=>s.form.nom=l),type:"text",class:f(["form-control",{error:s.errors.nom}]),placeholder:"France, Canada, Allemagne...",required:""},null,2),[[k,s.form.nom]]),s.errors.nom?(c(),m("span",oe,r(s.errors.nom),1)):y("",!0)]),e("div",se,[e("div",te,[o[15]||(o[15]=e("label",{for:"code_iso",class:"required"},"Code ISO",-1)),C(e("input",{id:"code_iso","onUpdate:modelValue":o[2]||(o[2]=l=>s.form.code_iso=l),type:"text",class:f(["form-control",{error:s.errors.code_iso}]),placeholder:"FR, CA, DE...",maxlength:"3",style:{"text-transform":"uppercase"},required:""},null,2),[[k,s.form.code_iso]]),s.errors.code_iso?(c(),m("span",ae,r(s.errors.code_iso),1)):y("",!0)]),e("div",ie,[o[16]||(o[16]=e("label",{for:"drapeau_emoji"},"Drapeau (emoji)",-1)),C(e("input",{id:"drapeau_emoji","onUpdate:modelValue":o[3]||(o[3]=l=>s.form.drapeau_emoji=l),type:"text",class:"form-control emoji-input",placeholder:"🇫🇷",maxlength:"4"},null,512),[[k,s.form.drapeau_emoji]]),o[17]||(o[17]=e("small",{class:"form-help"},"Utilisez l'emoji du drapeau du pays",-1))])]),e("div",le,[o[18]||(o[18]=e("label",{for:"description"},"Description",-1)),C(e("textarea",{id:"description","onUpdate:modelValue":o[4]||(o[4]=l=>s.form.description=l),class:"form-control",rows:"3",placeholder:"Description optionnelle du système éducatif ou autres informations..."},null,512),[[k,s.form.description]])])]),e("div",ne,[o[25]||(o[25]=e("h3",null,[e("i",{class:"fas fa-cog"}),b(" Configuration")],-1)),e("div",re,[e("div",de,[o[20]||(o[20]=e("label",{for:"ordre"},"Ordre d'affichage",-1)),C(e("input",{id:"ordre","onUpdate:modelValue":o[5]||(o[5]=l=>s.form.ordre=l),type:"number",class:"form-control",min:"0",placeholder:"0"},null,512),[[k,s.form.ordre,void 0,{number:!0}]]),o[21]||(o[21]=e("small",{class:"form-help"},"Plus le nombre est petit, plus le pays apparaît en premier",-1))]),e("div",ce,[e("div",me,[e("label",ue,[C(e("input",{"onUpdate:modelValue":o[6]||(o[6]=l=>s.form.est_actif=l),type:"checkbox",class:"checkbox-input"},null,512),[[R,s.form.est_actif]]),o[22]||(o[22]=e("span",{class:"checkbox-custom"},null,-1)),o[23]||(o[23]=b(" Pays actif "))]),o[24]||(o[24]=e("small",{class:"form-help"},"Les pays inactifs ne sont pas visibles aux utilisateurs",-1))])])])]),s.form.nom||s.form.drapeau_emoji?(c(),m("div",fe,[o[26]||(o[26]=e("h3",null,[e("i",{class:"fas fa-eye"}),b(" Aperçu")],-1)),e("div",ve,[e("span",ye,r(s.form.drapeau_emoji||"🏳️"),1),e("div",_e,[e("strong",null,r(s.form.nom||"Nom du pays"),1),s.form.code_iso?(c(),m("small",be,"["+r(s.form.code_iso)+"]",1)):y("",!0),s.form.description?(c(),m("p",pe,r(s.form.description),1)):y("",!0)]),s.form.est_actif?(c(),m("span",Ce,"Actif")):(c(),m("span",ge,"Inactif"))])])):y("",!0)],32),e("div",he,[e("button",{onClick:o[8]||(o[8]=l=>n.$emit("cancel")),type:"button",class:"btn btn-secondary"},o[27]||(o[27]=[e("i",{class:"fas fa-times"},null,-1),b(" Annuler ")])),e("button",{onClick:o[9]||(o[9]=(...l)=>s.handleSubmit&&s.handleSubmit(...l)),type:"submit",class:"btn btn-primary",disabled:!s.isFormValid},[o[28]||(o[28]=e("i",{class:"fas fa-save"},null,-1)),b(" "+r(a.mode==="create"?"Créer le pays":"Sauvegarder"),1)],8,ke)])])])):y("",!0)}const Pe=S(X,[["render",we],["__scopeId","data-v-b0f669a0"]]),Me={name:"ConfirmModal",props:{visible:{type:Boolean,default:!1},title:{type:String,default:"Confirmation"},message:{type:String,default:"Êtes-vous sûr de vouloir continuer ?"},danger:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(n,{emit:o}){return{handleOverlayClick:()=>{o("cancel")}}}},Se={class:"modal-body"},je={class:"modal-footer"};function xe(n,o,a,s,p,g){return a.visible?(c(),m("div",{key:0,class:"modal-overlay",onClick:o[3]||(o[3]=(...l)=>s.handleOverlayClick&&s.handleOverlayClick(...l))},[e("div",{class:"modal-container",onClick:o[2]||(o[2]=A(()=>{},["stop"]))},[e("div",{class:f(["modal-header",{danger:a.danger}])},[e("h3",null,[e("i",{class:f(a.danger?"fas fa-exclamation-triangle":"fas fa-question-circle")},null,2),b(" "+r(a.title),1)])],2),e("div",Se,[e("p",null,r(a.message),1)]),e("div",je,[e("button",{onClick:o[0]||(o[0]=l=>n.$emit("cancel")),class:"btn btn-secondary"},o[4]||(o[4]=[e("i",{class:"fas fa-times"},null,-1),b(" Annuler ")])),e("button",{onClick:o[1]||(o[1]=l=>n.$emit("confirm")),class:f(["btn",a.danger?"btn-danger":"btn-primary"])},[e("i",{class:f(a.danger?"fas fa-trash":"fas fa-check")},null,2),b(" "+r(a.danger?"Supprimer":"Confirmer"),1)],2)])])])):y("",!0)}const Ae=S(Me,[["render",xe],["__scopeId","data-v-46633de2"]]),Oe={name:"PaysAdmin",components:{PaysModal:Pe,ConfirmModal:Ae},setup(){const n=v([]),o=v([]),a=v(""),s=v("all"),p=v(!1),g=v(!1),l=v(!1),h=v(!1),t=v(null),d=v(null),j=v(null),P=async()=>{p.value=!0;try{const i=await J();n.value=i.results||i,M()}catch{_("Erreur lors du chargement des pays","error")}finally{p.value=!1}},M=()=>{let i=n.value;if(s.value==="active"?i=i.filter(u=>u.est_actif):s.value==="inactive"&&(i=i.filter(u=>!u.est_actif)),a.value){const u=a.value.toLowerCase();i=i.filter(w=>w.nom.toLowerCase().includes(u)||w.code_iso.toLowerCase().includes(u)||w.description&&w.description.toLowerCase().includes(u))}o.value=i.sort((u,w)=>(u.ordre||0)-(w.ordre||0))},U=i=>{s.value=i,M()},E=i=>{t.value={...i},l.value=!0},T=async i=>{try{g.value?(await W(i),_("Pays créé avec succès","success")):(await x(t.value.id,i),_("Pays modifié avec succès","success")),F(),await P()}catch{_("Erreur lors de la sauvegarde","error")}},N=async i=>{try{await x(i.id,{est_actif:!i.est_actif}),i.est_actif=!i.est_actif,_(`Pays ${i.est_actif?"activé":"désactivé"} avec succès`,"success"),M()}catch{_("Erreur lors du changement de statut","error")}},L=async i=>{try{await x(i.id,{ordre:i.ordre}),_("Ordre mis à jour","success"),M()}catch{_("Erreur lors de la mise à jour de l'ordre","error"),await P()}},q=i=>{d.value=i,h.value=!0},B=async()=>{try{await Q(d.value.id),_("Pays supprimé avec succès","success"),h.value=!1,await P()}catch{_("Erreur lors de la suppression","error")}},F=()=>{g.value=!1,l.value=!1,t.value=null},_=(i,u="info")=>{j.value={message:i,type:u},setTimeout(()=>{j.value=null},4e3)},z=i=>{const u={success:"fas fa-check-circle",error:"fas fa-exclamation-circle",warning:"fas fa-exclamation-triangle",info:"fas fa-info-circle"};return u[i]||u.info};return D(P),{pays:n,filteredPays:o,searchTerm:a,activeFilter:s,loading:p,showCreateModal:g,showEditModal:l,showDeleteModal:h,selectedPays:t,paysToDelete:d,notification:j,loadPays:P,filterPays:M,setFilter:U,editPays:E,handleSavePays:T,togglePaysStatus:N,updatePaysOrdre:L,confirmDelete:q,handleDeletePays:B,closeModals:F,showNotification:_,getNotificationIcon:z}}},Fe={class:"pays-admin"},Ie={class:"admin-header"},Ve={class:"filters-section"},De={class:"search-box"},Ue={class:"filter-buttons"},Ee={class:"pays-table-container"},Te={class:"pays-table"},Ne={class:"pays-cell"},Le={class:"pays-flag"},qe={class:"pays-info"},Be={key:0},ze={class:"code-iso"},Ge={class:"count-badge"},Re={class:"count-badge"},Ze=["onUpdate:modelValue","onChange"],He={class:"actions-cell"},Ke=["onClick"],Je=["onClick","title"],Qe={class:"action-label"},We=["onClick"],Xe={key:0,class:"empty-state"},Ye={key:0},$e={key:1};function eo(n,o,a,s,p,g){const l=O("PaysModal"),h=O("ConfirmModal");return c(),m("div",Fe,[e("div",Ie,[o[8]||(o[8]=e("div",{class:"header-content"},[e("h1",null,"Gestion des Pays"),e("p",null,"Administrez les pays et leurs systèmes éducatifs")],-1)),e("button",{onClick:o[0]||(o[0]=t=>s.showCreateModal=!0),class:"btn btn-primary"}," Ajouter un pays ")]),e("div",Ve,[e("div",De,[C(e("input",{"onUpdate:modelValue":o[1]||(o[1]=t=>s.searchTerm=t),type:"text",placeholder:"Rechercher un pays...",onInput:o[2]||(o[2]=(...t)=>s.filterPays&&s.filterPays(...t))},null,544),[[k,s.searchTerm]])]),e("div",Ue,[e("button",{class:f(["filter-btn",{active:s.activeFilter==="all"}]),onClick:o[3]||(o[3]=t=>s.setFilter("all"))}," Tous ("+r(s.pays.length)+") ",3),e("button",{class:f(["filter-btn",{active:s.activeFilter==="active"}]),onClick:o[4]||(o[4]=t=>s.setFilter("active"))}," Actifs ("+r(s.pays.filter(t=>t.est_actif).length)+") ",3),e("button",{class:f(["filter-btn",{active:s.activeFilter==="inactive"}]),onClick:o[5]||(o[5]=t=>s.setFilter("inactive"))}," Inactifs ("+r(s.pays.filter(t=>!t.est_actif).length)+") ",3)])]),e("div",Ee,[e("table",Te,[o[11]||(o[11]=e("thead",null,[e("tr",null,[e("th",null,"Pays"),e("th",null,"Code ISO"),e("th",null,"Statut"),e("th",null,"Niveaux"),e("th",null,"Utilisateurs"),e("th",null,"Ordre"),e("th",null,"Actions")])],-1)),e("tbody",null,[(c(!0),m(Z,null,H(s.filteredPays,t=>(c(),m("tr",{key:t.id,class:f({inactive:!t.est_actif})},[e("td",Ne,[e("span",Le,r(t.drapeau_emoji||"🏳️"),1),e("div",qe,[e("strong",null,r(t.nom),1),t.description?(c(),m("small",Be,r(t.description),1)):y("",!0)])]),e("td",null,[e("span",ze,r(t.code_iso),1)]),e("td",null,[e("span",{class:f(["status-badge",t.est_actif?"active":"inactive"])},r(t.est_actif?"Actif":"Inactif"),3)]),e("td",null,[e("span",Ge,r(t.nombre_niveaux||0),1)]),e("td",null,[e("span",Re,r(t.nombre_utilisateurs||0),1)]),e("td",null,[C(e("input",{"onUpdate:modelValue":d=>t.ordre=d,type:"number",class:"ordre-input",onChange:d=>s.updatePaysOrdre(t),min:"0"},null,40,Ze),[[k,t.ordre,void 0,{number:!0}]])]),e("td",He,[e("button",{onClick:d=>s.editPays(t),class:"action-btn edit-btn",title:"Modifier"},o[9]||(o[9]=[e("span",{class:"action-label"},"Éditer",-1)]),8,Ke),e("button",{onClick:d=>s.togglePaysStatus(t),class:f(["action-btn",t.est_actif?"deactivate-btn":"activate-btn"]),title:t.est_actif?"Désactiver":"Activer"},[e("span",Qe,r(t.est_actif?"Actif":"Inactif"),1)],10,Je),e("button",{onClick:d=>s.confirmDelete(t),class:"action-btn delete-btn",title:"Supprimer"},o[10]||(o[10]=[e("span",{class:"action-label"},"Supprimer",-1)]),8,We)])],2))),128))])]),s.filteredPays.length===0?(c(),m("div",Xe,[o[12]||(o[12]=e("div",{class:"empty-icon"},"🌍",-1)),o[13]||(o[13]=e("h3",null,"Aucun pays trouvé",-1)),s.searchTerm?(c(),m("p",Ye,'Aucun pays ne correspond à votre recherche "'+r(s.searchTerm)+'"',1)):(c(),m("p",$e,"Commencez par ajouter votre premier pays.")),e("button",{onClick:o[6]||(o[6]=t=>s.showCreateModal=!0),class:"btn btn-primary"}," Ajouter un pays ")])):y("",!0)]),s.showCreateModal||s.showEditModal?(c(),V(l,{key:0,visible:s.showCreateModal||s.showEditModal,pays:s.selectedPays,mode:s.showCreateModal?"create":"edit",onSave:s.handleSavePays,onCancel:s.closeModals},null,8,["visible","pays","mode","onSave","onCancel"])):y("",!0),s.showDeleteModal?(c(),V(h,{key:1,visible:s.showDeleteModal,title:`Supprimer ${s.paysToDelete?.nom}`,message:`Êtes-vous sûr de vouloir supprimer le pays ${s.paysToDelete?.nom} ? Cette action est irréversible.`,danger:"",onConfirm:s.handleDeletePays,onCancel:o[7]||(o[7]=t=>s.showDeleteModal=!1)},null,8,["visible","title","message","onConfirm"])):y("",!0),s.notification?(c(),m("div",{key:2,class:f(["notification",s.notification.type])},[e("i",{class:f(s.getNotificationIcon(s.notification.type))},null,2),b(" "+r(s.notification.message),1)],2)):y("",!0)])}const oo=S(Oe,[["render",eo],["__scopeId","data-v-23661c0e"]]),so={name:"AdminPays",components:{PaysAdmin:oo}},to={class:"admin-pays-wrapper"};function ao(n,o,a,s,p,g){const l=O("PaysAdmin");return c(),m("div",to,[K(l)])}const mo=S(so,[["render",ao],["__scopeId","data-v-f0497c6b"]]);export{mo as default};
