import{b as n,d as o,g as m,h as _,A as b,e as y,w as k,k as c,K as v,t as f,a as r,B as S,M as g,y as x,o as i,j as V}from"./vendor-D171CWhe.js";import{_ as R,o as N}from"./index-lv_OcPRH.js";import"./ui-jaH5oyHW.js";import"./pdf-B39ievqC.js";import"./mathlive-B5k0jhbN.js";const h={name:"PasswordReset",setup(){const p=g();x();const e=r(""),l=r(""),s=r(""),d=r(!1),t=r(""),u=r(!1);return S(()=>{e.value=(p.query.token||"").toString(),e.value||(t.value="Lien invalide ou expiré.")}),{token:e,password:l,password2:s,loading:d,error:t,isSuccess:u,onSubmit:async()=>{if(t.value="",!e.value){t.value="Lien invalide ou expiré.";return}if(l.value!==s.value){t.value="Les mots de passe ne correspondent pas.";return}try{d.value=!0,await N({token:e.value,password:l.value}),u.value=!0}catch(w){t.value=w?.response?.data?.detail||"Impossible de réinitialiser le mot de passe."}finally{d.value=!1}}}}},B={class:"page auth-page"},C={class:"auth-card"},L={key:0,class:"subtitle"},M={key:1,class:"success"},q={class:"field"},E={class:"field"},P={class:"actions"},j=["disabled"],D={key:0,class:"error"};function I(p,e,l,s,d,t){const u=y("router-link");return i(),n("div",B,[o("div",C,[e[7]||(e[7]=o("h1",{class:"title"},"Réinitialiser le mot de passe",-1)),s.isSuccess?m("",!0):(i(),n("p",L," Entrez votre nouveau mot de passe. Le lien est valable une seule fois. ")),s.isSuccess?(i(),n("div",M,[e[4]||(e[4]=o("p",null,"✅ Votre mot de passe a été mis à jour.",-1)),_(u,{class:"btn",to:{name:"Home"}},{default:b(()=>e[3]||(e[3]=[V("Se connecter")])),_:1,__:[3]})])):(i(),n("form",{key:2,onSubmit:e[2]||(e[2]=k((...a)=>s.onSubmit&&s.onSubmit(...a),["prevent"])),class:"form"},[o("div",q,[e[5]||(e[5]=o("label",null,"Nouveau mot de passe",-1)),c(o("input",{type:"password","onUpdate:modelValue":e[0]||(e[0]=a=>s.password=a),required:"",minlength:"6",autocomplete:"new-password"},null,512),[[v,s.password]])]),o("div",E,[e[6]||(e[6]=o("label",null,"Confirmer le mot de passe",-1)),c(o("input",{type:"password","onUpdate:modelValue":e[1]||(e[1]=a=>s.password2=a),required:"",minlength:"6",autocomplete:"new-password"},null,512),[[v,s.password2]])]),o("div",P,[o("button",{class:"btn primary",disabled:s.loading},f(s.loading?"En cours...":"Valider"),9,j)]),s.error?(i(),n("p",D,f(s.error),1)):m("",!0)],32))])])}const K=R(h,[["render",I],["__scopeId","data-v-7e1daaf4"]]);export{K as default};
