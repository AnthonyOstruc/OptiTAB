import{a as d,c as w,A as C,b as i,d as t,g as N,k as m,L as _,F as c,p as f,B as b,t as a,w as D,o as r,m as S,h as V,u as M}from"./vendor-CPU10QdV.js";import{g as B,u as E,c as T,d as F}from"./notions-TUY5U38Z.js";import{g as L}from"./themes-y5X3cFVH.js";import{_ as U}from"./index-BhTphZWV.js";import"./PaysNiveauxSelector.vue_vue_type_style_index_0_scoped_6652d9f9_lang-l0sNRNKZ.js";import"./PaysNiveauxDisplay.vue_vue_type_style_index_0_scoped_821033d6_lang-l0sNRNKZ.js";import{A as q}from"./AdminActionsButtons-ClSGDHPQ.js";import"./ui-es3YBeq-.js";import"./pdf-OEFxGcL4.js";import"./mathlive-B5k0jhbN.js";const I={class:"form-group"},j=["value"],z={class:"form-group"},G={class:"btn-primary",type:"submit"},P={class:"filters"},R={class:"filter-group"},H=["value"],J={class:"filter-group"},K={class:"admin-table"},O={key:1,class:"no-theme"},Q={key:0},W={__name:"AdminNotions",setup(X){const v=d([]),u=d([]),l=d({id:null,nom:"",theme:"",niveaux:[]}),s=d({theme:"",nom:""}),y=w(()=>{let n=v.value;return s.value.theme&&(n=n.filter(e=>String(e.theme)===String(s.value.theme))),s.value.nom&&(n=n.filter(e=>e.nom.toLowerCase().includes(s.value.nom.toLowerCase()))),n});async function p(){try{const[{data:n},{data:e}]=await Promise.all([B(),L()]);v.value=n||[],u.value=e||[]}catch{v.value=[],u.value=[]}}C(p);function h(){l.value={id:null,nom:"",theme:"",niveaux:[]}}async function g(){if(!(!l.value.nom||!l.value.theme))try{const n={nom:l.value.nom,theme:Number(l.value.theme),niveaux:[]};l.value.id?await E(l.value.id,n):await T(n),h(),await p()}catch{}}function x(n){n.niveaux&&n.niveaux.map(e=>e.id),l.value={id:n.id,nom:n.nom,theme:n.theme||"",niveaux:[]}}async function k(n){try{await F(n),await p()}catch{}}function A(n){k(n.id)}return(n,e)=>(r(),i("div",null,[e[12]||(e[12]=t("h2",{class:"admin-title"},"Gestion des Notions",-1)),t("form",{class:"admin-form",onSubmit:D(g,["prevent"])},[t("div",I,[e[5]||(e[5]=t("label",null,"Thème (lié à un contexte Matière + Niveau):",-1)),m(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>l.value.theme=o),required:""},[e[4]||(e[4]=t("option",{value:""},"Choisir un thème",-1)),(r(!0),i(c,null,f(u.value,o=>(r(),i("option",{key:o.id,value:o.id},a(o.nom)+" — "+a(o.contexte_detail?.matiere_nom)+" — "+a(o.contexte_detail?.pays?.nom)+" - "+a(o.contexte_detail?.niveau?.nom),9,j))),128))],512),[[_,l.value.theme]])]),t("div",z,[e[6]||(e[6]=t("label",null,"Nom de la notion:",-1)),m(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.nom=o),placeholder:"Nom de la notion",required:""},null,512),[[b,l.value.nom]])]),t("button",G,a(l.value.id?"Mettre à jour":"Créer"),1),l.value.id?(r(),i("button",{key:0,class:"btn-secondary",type:"button",onClick:h},"Annuler")):N("",!0)],32),t("div",P,[t("div",R,[e[8]||(e[8]=t("label",null,"Filtrer par thème:",-1)),m(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>s.value.theme=o)},[e[7]||(e[7]=t("option",{value:""},"Tous les thèmes",-1)),(r(!0),i(c,null,f(u.value,o=>(r(),i("option",{key:o.id,value:o.id},a(o.nom)+" — "+a(o.contexte_detail?.matiere_nom)+" — "+a(o.contexte_detail?.pays?.nom)+" - "+a(o.contexte_detail?.niveau?.nom),9,H))),128))],512),[[_,s.value.theme]])]),t("div",J,[e[9]||(e[9]=t("label",null,"Rechercher:",-1)),m(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>s.value.nom=o),type:"text",placeholder:"Nom de la notion..."},null,512),[[b,s.value.nom]])])]),t("table",K,[e[11]||(e[11]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"Nom de la notion"),t("th",null,"Thème"),t("th",null,"Actions")])],-1)),t("tbody",null,[(r(!0),i(c,null,f(y.value,o=>(r(),i("tr",{key:o.id},[t("td",null,a(o.id),1),t("td",null,a(o.nom),1),t("td",null,[o.theme_nom?(r(),i("span",{key:0,class:"theme-badge",style:S({backgroundColor:o.theme_couleur,color:"#fff"})},a(o.theme_nom),5)):(r(),i("span",O,"Aucun thème"))]),t("td",null,[V(M(q),{item:o,actions:["edit","delete"],"edit-label":"Éditer","confirm-message":"Êtes-vous sûr de vouloir supprimer cette notion ?",onEdit:x,onDelete:A},null,8,["item"])])]))),128)),y.value.length===0?(r(),i("tr",Q,e[10]||(e[10]=[t("td",{colspan:"4",style:{"text-align":"center","font-style":"italic"}},"Aucune notion trouvée.",-1)]))):N("",!0)])])]))}},re=U(W,[["__scopeId","data-v-a2971f5a"]]);export{re as default};
