import{M as N,a as r,c as $,B as O,b as i,d as s,g as _,j as w,t as a,m,F as y,p as k,y as S,o as l,n as z}from"./vendor-D171CWhe.js";import{_ as A,b as I}from"./index-D9PhsPPd.js";import"./ui-jaH5oyHW.js";import"./pdf-B39ievqC.js";import"./mathlive-B5k0jhbN.js";const L={class:"child-overview"},R={class:"header"},T={class:"title"},V={key:0,class:"subtitle"},E={key:0,class:"flag"},F={key:1,class:"niveau"},P={key:0,class:"loading"},H={key:1},X={class:"kpis"},G={class:"kpi"},J={class:"value primary"},K={class:"hint"},Q={class:"kpi"},U={class:"value"},W={class:"kpi"},Y={class:"value ok"},Z={class:"kpi"},ss={class:"value ko"},es={class:"cards-grid"},ts={class:"card"},as={class:"card-header"},is={class:"meta"},ls={class:"progress-bar"},os={class:"progress-hint"},ns={class:"card"},cs={class:"trend"},rs={class:"bar-bg"},ds={class:"bar-label"},us={class:"card"},vs={key:0,class:"activity"},_s={class:"text"},hs={class:"meta"},ps={key:0},ms={class:"when"},ys={key:1,class:"empty"},ks={class:"card"},fs={key:0,class:"matieres"},gs={class:"matiere-name"},bs={class:"matiere-stats"},ws={class:"badge total"},xs={class:"badge ok"},Ms={class:"badge ko"},Ds={key:1,class:"empty"},Cs={__name:"ChildOverview",setup(js){const x=N(),M=S(),D=x.params.childId,f=r(!0),n=r({}),c=r({}),h=r([]),d=r([]),u=r([]);function C(){M.back()}function j(o){return new Date(o).toLocaleDateString(void 0,{weekday:"short"})}function g(o){return Math.min(8,Math.max(0,Number(o||0)))*10+"px"}function q(o){if(!o)return"";const e=new Date(o),t=Date.now()-e.getTime(),v=Math.floor(t/6e4);if(v<1)return"√† l'instant";if(v<60)return`il y a ${v} min`;const p=Math.floor(v/60);if(p<24)return`il y a ${p} h`;const b=Math.floor(p/24);return b<7?`il y a ${b} j`:e.toLocaleDateString()}const B=$(()=>{const o=c.value?.weekly_done||0,e=c.value?.weekly_goal||20,t=Math.max(0,e-o);return t===0?"Objectif atteint üéØ":`${t} exercice(s) restants cette semaine`});return O(async()=>{try{const e=(await I.get(`/api/users/children/${D}/overview/`))?.data?.data||{};n.value=e.child||{},c.value=e.metrics||{},h.value=e.weekly_trend||[],d.value=e.last_activities||[],u.value=e.by_matieres||[]}catch{n.value={},c.value={},h.value=[],d.value=[],u.value=[]}finally{f.value=!1}}),(o,e)=>(l(),i("div",L,[s("div",R,[s("button",{class:"back",onClick:C},"‚Üê Retour"),s("div",T,[e[0]||(e[0]=s("h1",null,"D√©tail de l'√©l√®ve",-1)),n.value.display_name?(l(),i("p",V,[w(a(n.value.display_name)+" ",1),n.value.pays_flag?(l(),i("span",E,a(n.value.pays_flag),1)):_("",!0),n.value.niveau?(l(),i("span",F,"‚Ä¢ "+a(n.value.niveau),1)):_("",!0)])):_("",!0)])]),f.value?(l(),i("div",P,e[1]||(e[1]=[s("span",{class:"spinner"},null,-1)]))):(l(),i("div",H,[s("div",X,[s("div",G,[e[2]||(e[2]=s("div",{class:"label"},"XP",-1)),s("div",J,a(n.value.xp),1),s("div",K,"Niveau "+a(n.value.level),1)]),s("div",Q,[e[3]||(e[3]=s("div",{class:"label"},"Exercices r√©alis√©s",-1)),s("div",U,a(c.value.done_total),1)]),s("div",W,[e[4]||(e[4]=s("div",{class:"label"},"Acquis",-1)),s("div",Y,a(c.value.acquired_count),1)]),s("div",Z,[e[5]||(e[5]=s("div",{class:"label"},"√Ä revoir",-1)),s("div",ss,a(c.value.not_acquired_count),1)])]),s("div",es,[s("div",ts,[s("div",as,[e[6]||(e[6]=s("h3",null,"Objectif hebdomadaire",-1)),s("div",is,a(c.value.weekly_done)+" / "+a(c.value.weekly_goal),1)]),s("div",ls,[s("div",{class:"fill",style:m({width:c.value.weekly_progress+"%"})},null,4)]),s("div",os,a(B.value),1)]),s("div",ns,[e[7]||(e[7]=s("div",{class:"card-header"},[s("h3",null,"Tendance 7 jours")],-1)),s("div",cs,[(l(!0),i(y,null,k(h.value,t=>(l(),i("div",{key:t.date,class:"bar-col"},[s("div",rs,[s("div",{class:"bar-ok",style:m({height:g(t.correct)})},null,4),s("div",{class:"bar-total",style:m({height:g(t.total)})},null,4)]),s("div",ds,a(j(t.date)),1)]))),128))])]),s("div",us,[e[8]||(e[8]=s("div",{class:"card-header"},[s("h3",null,"Activit√© r√©cente")],-1)),d.value.length?(l(),i("ul",vs,[(l(!0),i(y,null,k(d.value,t=>(l(),i("li",{key:t.id,class:"activity-item"},[s("span",{class:z(["status",{ok:t.est_correct,ko:!t.est_correct}])},a(t.est_correct?"‚úÖ":"‚ùå"),3),s("span",_s,a(t.exercice_title),1),s("span",hs,[w("‚Ä¢ "+a(t.chapitre_title||"Chapitre")+" ",1),t.matiere?(l(),i("span",ps,"‚Ä¢ "+a(t.matiere),1)):_("",!0)]),s("span",ms,a(q(t.when)),1)]))),128))])):(l(),i("div",ys,"Aucune activit√© pour le moment."))]),s("div",ks,[e[9]||(e[9]=s("div",{class:"card-header"},[s("h3",null,"Mati√®res √† travailler")],-1)),u.value.length?(l(),i("div",fs,[(l(!0),i(y,null,k(u.value,t=>(l(),i("div",{class:"matiere",key:t.id},[s("div",gs,a(t.name),1),s("div",bs,[s("span",ws,a(t.total)+" exos",1),s("span",xs,a(t.acquired)+" acquis",1),s("span",Ms,a(t.to_review)+" √† revoir",1)])]))),128))])):(l(),i("div",Ds,"Pas encore de r√©partition par mati√®re."))])])]))]))}},Ss=A(Cs,[["__scopeId","data-v-72757fed"]]);export{Ss as default};
