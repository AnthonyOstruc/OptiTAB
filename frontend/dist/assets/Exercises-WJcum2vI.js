import{D as E}from"./DashboardLayout-CXlm3qBh.js";import{B as C}from"./BaseCard-BChY1vl5.js";import{_ as b,d as w,u as A}from"./index-Egejfov0.js";import{a as z,g as B}from"./matieres-BsMwIPVd.js";import{g as R}from"./themes-D1l3dXJQ.js";import{a as p,c as j,B as N,y as V,f as x,A as M,o,b as c,g as v,d as i,u,j as h,t as F,F as T,p as D,n as L,R as U}from"./vendor-D171CWhe.js";import{u as $}from"./useSmartNavigation-Cyzmd85q.js";import"./menuItems-D4F2gOe0.js";import"./ui-jaH5oyHW.js";import"./pdf-B39ievqC.js";import"./mathlive-B5k0jhbN.js";const q={key:0,class:"exercises-section"},P={key:0,class:"help-message"},G={class:"exercises-grid"},H={key:1,class:"no-matiere-message"},J={key:1,class:"loading-section"},K={__name:"Exercises",setup(O){const g=V(),r=p([]),_=p({}),l=p(!0),s=w(),f=A(),{checkAndRedirectIfNeeded:k}=$(),I=j(()=>!l.value);N(async()=>{try{if(l.value=!0,await k())return;try{const m=(await z())?.data?.matieres_disponibles||[];r.value=m.map(d=>({id:d.id,nom:d.nom,description:d.description||"",svg_icon:d.svg_icon||""}))}catch{const{data:m}=await B();r.value=m||[]}let e=s.activeMatiereId;const t=f.pays?.id||null,y=f.niveau_pays?.id||null;if(!e&&r.value.length>0&&(e=r.value[0].id,s.setActiveMatiere(e)),e){const n=await R(e,y,t);_.value[e]=Array.isArray(n?.data)?n.data:n?.data||[],g.push({name:"Themes",params:{matiereId:String(e)}});return}s.selectedMatieresIds.length>0&&s.activeMatiereId}catch{r.value=[]}finally{l.value=!1}});function S(a){try{s.isSelectedMatiere(a.id)||s.addMatiereId(a.id),s.setActiveMatiere(a.id),g.push({name:"Themes",params:{matiereId:a.id.toString()}})}catch{}}return(a,e)=>(o(),x(E,null,{default:M(()=>[I.value?(o(),c("section",q,[e[4]||(e[4]=i("h2",{class:"exercises-title"},"Choisissez une mati√®re pour vos exercices guid√©s",-1)),u(s).selectedMatieresIds.length>0?(o(),c("div",P,[i("p",null,[e[0]||(e[0]=h("üí° ")),e[1]||(e[1]=i("strong",null,"Astuce :",-1)),h(" Vous avez "+F(u(s).selectedMatieresIds.length)+" mati√®re(s) s√©lectionn√©e(s). Cliquez sur une mati√®re ci-dessous ou utilisez vos onglets en haut pour acc√©der directement √† vos mati√®res favorites.",1)])])):v("",!0),i("div",G,[(o(!0),c(T,null,D(r.value,t=>(o(),x(C,{key:t.id,title:t.nom,icon:t.svg_icon,description:t.description||"",class:L({favorite:u(s).isFavoriteMatiere(t.id)}),onClick:y=>S(t)},U({_:2},[u(s).isFavoriteMatiere(t.id)?{name:"badge",fn:M(()=>[e[2]||(e[2]=i("span",{class:"favorite-badge"},"‚≠ê",-1))]),key:"0"}:void 0]),1032,["title","icon","description","class","onClick"]))),128))]),r.value.length===0?(o(),c("div",H,e[3]||(e[3]=[i("p",null,"Aucune mati√®re n'est actuellement disponible.",-1),i("p",null,"Veuillez r√©essayer plus tard ou contactez l'administrateur.",-1)]))):v("",!0)])):l.value?(o(),c("section",J,e[5]||(e[5]=[i("div",{class:"loading-spinner"},[i("p",null,"Chargement de vos exercices...")],-1)]))):v("",!0)]),_:1}))}},oe=b(K,[["__scopeId","data-v-8d4c7fa9"]]);export{oe as default};
