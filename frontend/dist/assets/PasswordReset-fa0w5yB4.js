import{b as n,d as o,i as m,j as _,C as b,g as y,w as k,m as c,K as v,t as f,a as r,e as S,L as g,A as x,o as i,l as V}from"./vendor-1gmgAmFu.js";import{_ as R,p as C}from"./index-DdsjLnq7.js";import"./ui-jaH5oyHW.js";import"./pdf-B39ievqC.js";import"./mathlive-B5k0jhbN.js";const L={name:"PasswordReset",setup(){const p=g();x();const e=r(""),l=r(""),s=r(""),d=r(!1),t=r(""),u=r(!1);return S(()=>{e.value=(p.query.token||"").toString(),e.value||(t.value="Lien invalide ou expiré.")}),{token:e,password:l,password2:s,loading:d,error:t,isSuccess:u,onSubmit:async()=>{if(t.value="",!e.value){t.value="Lien invalide ou expiré.";return}if(l.value!==s.value){t.value="Les mots de passe ne correspondent pas.";return}try{d.value=!0,await C({token:e.value,password:l.value}),u.value=!0}catch(w){t.value=w?.response?.data?.detail||"Impossible de réinitialiser le mot de passe."}finally{d.value=!1}}}}},N={class:"page auth-page"},h={class:"auth-card"},q={key:0,class:"subtitle"},B={key:1,class:"success"},E={class:"field"},M={class:"field"},P={class:"actions"},j=["disabled"],D={key:0,class:"error"};function I(p,e,l,s,d,t){const u=y("router-link");return i(),n("div",N,[o("div",h,[e[7]||(e[7]=o("h1",{class:"title"},"Réinitialiser le mot de passe",-1)),s.isSuccess?m("",!0):(i(),n("p",q," Entrez votre nouveau mot de passe. Le lien est valable une seule fois. ")),s.isSuccess?(i(),n("div",B,[e[4]||(e[4]=o("p",null,"✅ Votre mot de passe a été mis à jour.",-1)),_(u,{class:"btn",to:{name:"Home"}},{default:b(()=>e[3]||(e[3]=[V("Se connecter")])),_:1,__:[3]})])):(i(),n("form",{key:2,onSubmit:e[2]||(e[2]=k((...a)=>s.onSubmit&&s.onSubmit(...a),["prevent"])),class:"form"},[o("div",E,[e[5]||(e[5]=o("label",null,"Nouveau mot de passe",-1)),c(o("input",{type:"password","onUpdate:modelValue":e[0]||(e[0]=a=>s.password=a),required:"",minlength:"6",autocomplete:"new-password"},null,512),[[v,s.password]])]),o("div",M,[e[6]||(e[6]=o("label",null,"Confirmer le mot de passe",-1)),c(o("input",{type:"password","onUpdate:modelValue":e[1]||(e[1]=a=>s.password2=a),required:"",minlength:"6",autocomplete:"new-password"},null,512),[[v,s.password2]])]),o("div",P,[o("button",{class:"btn primary",disabled:s.loading},f(s.loading?"En cours...":"Valider"),9,j)]),s.error?(i(),n("p",D,f(s.error),1)):m("",!0)],32))])])}const K=R(L,[["render",I],["__scopeId","data-v-dfc89383"]]);export{K as default};
