import{_ as q,u as E}from"./index-Egejfov0.js";import{a as R,f as _}from"./matieres-BsMwIPVd.js";import{a as f,b as u,d as s,j as l,t,u as m,g as y,F as N,p as T,o}from"./vendor-D171CWhe.js";import"./ui-jaH5oyHW.js";import"./pdf-B39ievqC.js";import"./mathlive-B5k0jhbN.js";const U={class:"test-filtrage-strict"},C={class:"user-info"},I={class:"test-section"},V=["disabled"],z={key:0,class:"result"},H={key:0,class:"matieres-list"},L={class:"matiere-header"},O=["innerHTML"],j={class:"matiere-nom"},w={class:"matiere-details"},B={key:1,class:"no-matieres"},D={class:"test-section"},Y=["disabled"],G={key:0,class:"result"},J={key:0,class:"matieres-list"},K={class:"matiere-header"},Q=["innerHTML"],W={class:"matiere-nom"},X={class:"matiere-type"},Z={__name:"TestFiltrageStrict",setup($){const r=E(),d=f(!1),i=f(null),v=f(null),M=async()=>{d.value=!0;try{const a=await R();i.value=a.data}catch(a){i.value={error:a.message}}finally{d.value=!1}},A=async()=>{d.value=!0;try{const a=r.pays?.id,e=r.niveau_pays?.id,p=(a?await _(a,null):{data:{matieres:[]}}).data.matieres||[],c=(e?await _(null,e):{data:{matieres:[]}}).data.matieres||[],b=[...p,...c].filter((F,k,x)=>k===x.findIndex(P=>P.id===F.id));v.value=b}catch{v.value=[]}finally{d.value=!1}},S=a=>{const e=r.pays?.id,n=r.niveau_pays?.id,p=a.pays_associes?.some(c=>c.id===e),g=a.niveaux_associes?.some(c=>c.id===n);return p&&g?"Pays ET Niveau":p?"Pays seulement":g?"Niveau seulement":"Aucun"};return(a,e)=>(o(),u("div",U,[e[20]||(e[20]=s("h1",null,"Test du Filtrage Strict des Matières",-1)),s("div",C,[e[4]||(e[4]=s("h2",null,"Configuration Utilisateur",-1)),s("p",null,[e[0]||(e[0]=s("strong",null,"Email:",-1)),l(" "+t(m(r).email),1)]),s("p",null,[e[1]||(e[1]=s("strong",null,"Pays:",-1)),l(" "+t(m(r).pays?.nom||"Non configuré")+" (ID: "+t(m(r).pays?.id)+")",1)]),s("p",null,[e[2]||(e[2]=s("strong",null,"Niveau:",-1)),l(" "+t(m(r).niveau_pays?.nom||"Non configuré")+" (ID: "+t(m(r).niveau_pays?.id)+")",1)]),s("p",null,[e[3]||(e[3]=s("strong",null,"Admin:",-1)),l(" "+t(m(r).isAdmin?"Oui":"Non"),1)])]),s("div",I,[e[14]||(e[14]=s("h2",null,"Test du Filtrage Strict",-1)),e[15]||(e[15]=s("p",{class:"info"},[s("strong",null,"Nouveau comportement :"),l(" Seules les matières qui correspondent AU PAYS ET AU NIVEAU de l'utilisateur seront affichées. ")],-1)),s("button",{onClick:M,disabled:d.value,class:"test-button"},t(d.value?"Test en cours...":"Tester le Filtrage Strict"),9,V),i.value?(o(),u("div",z,[e[12]||(e[12]=s("h3",null,"Résultats du Test",-1)),s("p",null,[e[5]||(e[5]=s("strong",null,"Status:",-1)),l(" "+t(i.value.status),1)]),s("p",null,[e[6]||(e[6]=s("strong",null,"Message:",-1)),l(" "+t(i.value.message),1)]),e[13]||(e[13]=s("p",null,[s("strong",null,"Filtres appliqués:")],-1)),s("ul",null,[s("li",null,"Pays: "+t(i.value.filtres_appliques?.pays?"Oui":"Non"),1),s("li",null,"Niveau: "+t(i.value.filtres_appliques?.niveau?"Oui":"Non"),1)]),s("p",null,[e[7]||(e[7]=s("strong",null,"Matières disponibles:",-1)),l(" "+t(i.value.matieres_disponibles?.length||0),1)]),i.value.matieres_disponibles&&i.value.matieres_disponibles.length>0?(o(),u("div",H,[e[10]||(e[10]=s("h4",null,"Matières filtrées (Pays ET Niveau):",-1)),(o(!0),u(N,null,T(i.value.matieres_disponibles,n=>(o(),u("div",{key:n.id,class:"matiere-item"},[s("div",L,[s("span",{class:"matiere-icon",innerHTML:n.svg_icon||"📚"},null,8,O),s("span",j,t(n.nom),1)]),s("div",w,[s("p",null,[e[8]||(e[8]=s("strong",null,"Pays associés:",-1)),l(" "+t(n.pays_associes?.map(p=>p.nom).join(", ")||"Aucun"),1)]),s("p",null,[e[9]||(e[9]=s("strong",null,"Niveaux associés:",-1)),l(" "+t(n.niveaux_associes?.map(p=>p.nom).join(", ")||"Aucun"),1)])])]))),128))])):(o(),u("div",B,e[11]||(e[11]=[s("p",null,"⚠️ Aucune matière ne correspond exactement à votre pays ET niveau.",-1),s("p",null,"Vérifiez que :",-1),s("ul",null,[s("li",null,"Votre pays et niveau sont correctement configurés"),s("li",null,"Il existe des matières associées à votre pays ET niveau")],-1)])))])):y("",!0)]),s("div",D,[e[18]||(e[18]=s("h2",null,"Comparaison avec l'Ancien Filtrage",-1)),e[19]||(e[19]=s("p",{class:"info"},[s("strong",null,"Ancien comportement :"),l(" Matières du pays OU du niveau (plus permissif) ")],-1)),s("button",{onClick:A,disabled:d.value,class:"test-button"},t(d.value?"Test en cours...":"Simuler l'Ancien Filtrage"),9,Y),v.value?(o(),u("div",G,[e[17]||(e[17]=s("h3",null,"Résultats de l'Ancien Filtrage (Simulation)",-1)),s("p",null,[e[16]||(e[16]=s("strong",null,"Matières (Pays OU Niveau):",-1)),l(" "+t(v.value.length),1)]),v.value.length>0?(o(),u("div",J,[(o(!0),u(N,null,T(v.value,n=>(o(),u("div",{key:n.id,class:"matiere-item old"},[s("div",K,[s("span",{class:"matiere-icon",innerHTML:n.svg_icon||"📚"},null,8,Q),s("span",W,t(n.nom),1),s("span",X,t(S(n)),1)])]))),128))])):y("",!0)])):y("",!0)]),e[21]||(e[21]=s("div",{class:"instructions"},[s("h2",null,"Instructions"),s("ol",null,[s("li",null,"Assurez-vous d'être connecté avec un utilisateur qui a un pays et un niveau configurés"),s("li",null,'Cliquez sur "Tester le Filtrage Strict" pour voir les matières qui correspondent exactement à votre configuration'),s("li",null,"Comparez avec l'ancien filtrage pour voir la différence"),s("li",null,[l("Vérifiez que le composant "),s("code",null,"SelectedMatiereHeader"),l(" utilise maintenant ce filtrage strict")])])],-1))]))}},as=q(Z,[["__scopeId","data-v-2e38abee"]]);export{as as default};
